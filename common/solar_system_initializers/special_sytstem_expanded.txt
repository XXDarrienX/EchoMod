@base_moon_distance = 6

@standard_min = 20 #26
@standard_max = 35 #30
@standard_sat_min = 15 #22
@standard_sat_max = 30 #27

# Mass Effect Citadel
special_expanded_widow = {
	name = "NAME_Widow"
	class = "sc_b"
	
	flags = { mass_effect_citadel_system }
	
	planet = {
		name = "NAME_Widow"
		class = "star"
		orbit_distance = 0
		
		init_effect = {
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = { 
				set_location = {
					target = prev
					distance = 50
					angle = random
				}
			}
		}
	}
	
	change_orbit = 45
	
	planet = {
		name = "NAME_Citadel"
		class = "pc_habitat"
		orbit_distance = 60
		orbit_angle = { min = 90 max = 270 }
		size = 100
		has_ring = no
		modifiers = none
		entity = "orbital_habitat_entity"
		flags = { mass_effect_citadel }
		
		init_effect = {
			prevent_anomaly = yes
			set_planet_flag = habitat_expanded_once
			set_planet_flag = habitat_expanded_twice
			add_deposit = d_presidium
			add_deposit = d_citadel_wards
			add_deposit = d_protein_vats
			add_deposit = d_engineered_keepers
			add_deposit = d_ruined_arcology
			add_deposit = d_ruined_arcology
			
			add_district = district_hab_housing
			add_district = district_hab_housing
			
			create_country = {
				name = "NAME_Citadel_Defense"
				type = faction
			}
			last_created_country = {
				save_event_target_as = sanctuary
				create_fleet = {
					name = "NAME_Sanctuary_Core"
					settings = { spawn_debris = no }
					effect = {
						set_owner = event_target:sanctuary
						create_ship = {
							name = "NAME_Administrator"
							design = "NAME_Sanctuary_Core"
							graphical_culture = "fallen_empire_03"
						}
						set_location = {
							target = PREVPREV
							distance = 11
							angle = random 
						}
						add_modifier = {
							modifier = sanctuary_power
							days = -1
						}						
						save_event_target_as = sanctuary_core
						set_fleet_flag = sanctuary_core
					}
				}
				create_fleet = {
					settings = { spawn_debris = no }
					effect = {
						set_owner = event_target:sanctuary
						create_ship = {
							name = random
							design = "NAME_Defensive_A_1"
							graphical_culture = "fallen_empire_03"
						}
						set_location = {
							target = event_target:sanctuary_core
							distance = 8
							angle = 90
						}
					}
				}
				create_fleet = {
					settings = { spawn_debris = no }
					effect = {
						set_owner = event_target:sanctuary
						create_ship = {
							name = random
							design = "NAME_Defensive_A_1"
							graphical_culture = "fallen_empire_03"
						}
						set_location = {
							target = event_target:sanctuary_core
							distance = 8
							angle = 180
						}
					}
				}
				create_fleet = {
					settings = { spawn_debris = no }
					effect = {
						set_owner = event_target:sanctuary
						create_ship = {
							name = random
							design = "NAME_Defensive_A_1"
							graphical_culture = "fallen_empire_03"
						}
						set_location = {
							target = event_target:sanctuary_core
							distance = 8
							angle = 270
						}
					}
				}
				create_fleet = {
					settings = { spawn_debris = no }
					effect = {
						set_owner = event_target:sanctuary
						create_ship = {
							name = random
							design = "NAME_Defensive_A_1"
							graphical_culture = "fallen_empire_03"
						}
						set_location = {
							target = event_target:sanctuary_core
							distance = 8
							angle = 0
						}
					}
				}
			}
			
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = { 
				set_location = {
					target = prev
					distance = 11
					angle = random
				}
			}
		}
	}
	
	init_effect = {
		spawn_megastructure = {
			type = "gateway_ruined"
			random_pos = yes
			orbit_angle = 360		# range of the randomization
		}
	}
	
}

dune_arrakis_system = {
	class = sc_f
	name = "NAME_alpha_carinae"
	flags = { arrakis_system }
	
	planet = {
		class = star
		size = { min = @standard_min max = @standard_max }
		orbit_distance = 0
	}
	
	planet = {
		class = random_non_colonizable
		count = 1
		orbit_angle = { min = 90 max = 270 }
		orbit_distance = 30
		change_orbit = 15
		flags = { hot_zone }
	}
	
	planet = {
		class = random_non_colonizable
		count = { min = 0 max = 1 }
		orbit_angle = { min = 90 max = 270 }
		orbit_distance = 30
		change_orbit = 15
		flags = { hot_zone }
	}
	
	planet = {
		count = 1
		orbit_distance = 25
		class = pc_arid
		orbit_angle = { min = 90 max = 270 }
		size = { min = 12 max = 18 }
		flags = { arrakis_planet }
		init_effect = {
			prevent_anomaly = yes
			add_deposit = d_dust_desert
			add_deposit = d_spice_mine
			add_deposit = d_dangerous_wildlife_blocker
			add_deposit = d_sand_worms
		}
	}
	
	planet = {
		class = random_non_colonizable
		count = 1
		orbit_angle = { min = 90 max = 270 }
		orbit_distance = 25
		change_orbit = 15
	}
	
	planet = {
		class = random_non_colonizable
		count = { min = 0 max = 1 }
		orbit_angle = { min = 90 max = 270 }
		orbit_distance = 35
		change_orbit = 15
	}

	planet = {
		count = 1
		orbit_distance = 40
		orbit_angle = { min = 90 max = 270 }
		class = pc_gas_giant
		
		change_orbit = @base_moon_distance
		
		moon = {
			count = { min = 0 max = 4 }
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
			class = random_non_colonizable
		}
	}
	
	planet = {
		count = { min = 0 max = 1 }
		orbit_distance = 45
		orbit_angle = { min = 90 max = 270 }
		class = pc_gas_giant
		
		change_orbit = @base_moon_distance
		
		moon = {
			count = { min = 0 max = 3 }
			class = random_non_colonizable
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}
	
	planet = {
		count = { min = 0 max = 1 }
		orbit_distance = 50
		orbit_angle = { min = 90 max = 270 }
		class = pc_gas_giant
		
		change_orbit = @base_moon_distance
		
		moon = {
			count = { min = 0 max = 4 }
			class = random_non_colonizable
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}	
}

### Deneb System
une_deneb_system = {
	name = "NAME_Deneb"
	class = "sc_a"
	asteroid_belt = {
		type = rocky_asteroid_belt
		radius = 90
	}

	init_effect = {
		every_neighbor_system = {
			set_star_flag = empire_cluster
			every_neighbor_system = {
				set_star_flag = empire_cluster
			}
		}
		
		generate_home_system_resources = yes
	}
	
	flags = { empire_home_system deneb_system }
	
	usage = custom_empire
	
	planet = {
		name = "NAME_Deneb"
		class = "pc_a_star"
		orbit_distance = 0
		orbit_angle = 1
		size = 40
		has_ring = no
	}
	
	planet = {
		name = "NAME_Inferno"
		class = "pc_molten"
		orbit_distance = 60
		orbit_angle = 45
		size = 10
		has_ring = no
	}
	
	planet = {
		name = "NAME_DT4-298"
		class = "pc_asteroid"
		orbit_distance = 30
		orbit_angle = 340
		size = 5
		has_ring = no
	}
	
	planet = {
		name = "NAME_LR-2129"
		class = "pc_asteroid"
		orbit_distance = 0
		orbit_angle = 160
		size = 5
		has_ring = no
	}
	
	planet = {
		name = "NAME_GR-345"
		class = "pc_asteroid"
		orbit_distance = 0
		orbit_angle = 270
		size = 5
		has_ring = no
	}
	
	planet = {
		name = "NAME_Olympus"
		class = "pc_gas_giant"
		orbit_distance = 30
		orbit_angle = 200
		size = 40
		has_ring = no
		entity = "gas_giant_02_entity"
		
		moon = {
			name = "NAME_New_Luna"
			class = "pc_frozen"
			size = 5
			orbit_distance = 18
			orbit_angle = 100
			has_ring = no
		}
		moon = {
			name = "NAME_Unity"
			class = pc_continental
			orbit_distance = 5
			orbit_angle = 340
			size = 18
			starting_planet = yes
			has_ring = no
			entity = "continental_planet_01_entity"	
			deposit_blockers = none
			modifiers = none
		
			init_effect = {
				prevent_anomaly = yes
				generate_empire_home_planet = yes
				random_country = {
					limit = { has_country_flag = human_1 }
					owner_species = { save_event_target_as = human_species }
				}
				create_country = {
					name = "NAME_Commonwealth_of_Man"
					authority = auth_dictatorial
					civics = {
						civic = civic_nationalistic_zeal
						civic = civic_distinguished_admiralty
					}
					species = event_target:human_species
					name_list = "HUMAN2"
					ethos = {
						ethic = "ethic_xenophobe"
						ethic = "ethic_fanatic_militarist"
					}
					flag = {
						icon= {
							category = "human"
							file = "flag_human_4.dds"
						}
						background= {
							category = "backgrounds"
							file = "stripe.dds"
						}
						colors={
							"red"
							"black"
							"null"
							"null"
						}
					}
					type = default
					effect = {
						set_country_flag = human_2
						save_event_target_as = npc_CoM
						add_resource = {
							minerals = 1000
							energy = 750
							food = 200
							alloys = 100
							consumer_goods = 100
							influence = 100
						}
						create_fleet = {
							effect = {
								set_owner = prev

								create_ship = {
									name = random
									random_existing_design = science
								}

								set_fleet_stance = evasive				
								#set_location = prev.capital_star
								set_location = prev.capital_scope.star
								
								owner = {
									create_leader = {
										class = scientist
										species = owner_main_species
										name = random
										skill = 2
									}
								}
								set_leader = last_created_leader
							}			
						}
							
						#constructor
						create_fleet = {
							effect = {
								set_owner = prev
								
								create_ship = {
									name = random
									random_existing_design = constructor
								}
								
								set_fleet_stance = evasive
								set_location = prev.capital_star
							}
						}
						
						#military
						create_fleet = {
							set_take_point = yes
							effect = {
								set_owner = prev
								
								while = {
									count = 2
									create_ship = {
										name = random
										random_existing_design = corvette
									}
								}
								
								set_location = prev.capital_star
							}
						}
						create_leader = {
							class = scientist
							species = owner_main_species
							name = random
							skill = 2
						}
						create_leader = {
							class = scientist
							species = owner_main_species
							name = random
							skill = 2
						}
						create_leader = {
							class = scientist
							species = owner_main_species
							name = random
							skill = 2
						}
						create_leader = {
							class = governor
							species = owner_main_species
							name = random
							skill = 2
						}
					}
				}
				while = {
					count = 26
					create_pop = {
						species = event_target:human_species
					}
				}
				set_owner = last_created_country
				set_capital = yes
				generate_start_deposits_and_blockers = yes
				add_deposit = d_chrysanthemum
				add_district = district_city
				add_district = district_city
				add_district = district_city
				add_district = district_city
				add_district = district_farming
				add_district = district_farming
				add_district = district_farming
				add_district = district_mining
				add_district = district_mining
				add_district = district_generator
				add_district = district_generator
				add_building = building_capital
				add_building = building_research_lab_1
				add_building = building_foundry_1
				add_building = building_factory_1
			}
		}		
	}
	
	planet = {
		name = "NAME_Marble"
		class = "pc_barren_cold"
		orbit_distance = 20
		orbit_angle = 325
		size = 10
		has_ring = no
	}
	
	planet = {
		name = "NAME_Hyperion"
		class = "pc_gas_giant"
		orbit_distance = 20
		orbit_angle = 110
		size = 30
		has_ring = no
		entity = "gas_giant_05_entity"
		
		moon = {
			name = "NAME_Helios"
			class = "pc_frozen"
			size = 8
			orbit_distance = 14
			orbit_angle = 14
			has_ring = no
		}
	}
	
	planet = {
		name = "NAME_Tumbleweed"
		class = "pc_barren"
		orbit_distance = 20
		orbit_angle = 35
		size = 15
		has_ring = no
	}
	
	planet = {
		name = "NAME_Jackson's_Planet"
		class = "pc_frozen"
		orbit_distance = 20
		orbit_angle = 150
		size = 20
		has_ring = no
	}
	
	neighbor_system = {
		trigger = { num_guaranteed_colonies >= 2 }
		distance = { min = 10 max = @distance }	
		initializer = "neighbor_t1"
	}
	neighbor_system = {
		trigger = { num_guaranteed_colonies >= 1 }
		distance = { min = 10 max = @distance }	
		initializer = "neighbor_t1_first_colony"
	}
}