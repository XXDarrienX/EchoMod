namespace = gai_clear

event = {
	id = gai_clear.1
	hide_window = yes
    is_triggered_only = yes 
	
	immediate = {
        every_country = {
            if = {
                limit = {
                    is_ai = yes
					not = { has_country_flag = gai_clear_fired }
					is_at_war = yes
                    is_country_type = default
                }
                country_event = { id = gai_clear.2 }
            }
			if = {
                limit = {
					has_country_flag = gai_clear_fired
					is_at_war = no
                    is_country_type = default
                }
                country_event = { id = gai_clear.3 }
            }
			if = {
                limit = {
                    is_ai = yes
					has_country_flag = gai_clear_fired
					not = { has_country_flag = transport_five_year_clear }
					is_at_war = yes
                    is_country_type = default
                }
            }
        }
	}
}

country_event = {
	id = gai_clear.2
	hide_window = yes
    is_triggered_only = yes 
    immediate = {
		random_owned_planet = {
			limit = {
				solar_system = { is_same_value = root.owner.capital_scope.solar_system }
			}
			save_event_target_as = go_to_home
		}

        every_owned_fleet = {
            limit = {
				OR = {
					AND = {
						is_ship_class = shipclass_transport
						has_fleet_order = land_armies_order
						has_fleet_order = orbit_planet_order 
					}
					AND = {
						is_ship_class = shipclass_military
						NOT = { has_fleet_order = merge_fleet_order }
					}
				}			
			}
            order_forced_return = yes
        }
		set_country_flag = gai_clear_fired
		set_timed_country_flag = {
			flag = transport_five_year_clear
			days = 2100
		}
    }
}

country_event = {
	id = gai_clear.3
	hide_window = yes
    is_triggered_only = yes 
    immediate = {
		if = {
			limit = {
				is_at_war = no
			}
			remove_country_flag = gai_clear_fired
		}
    }
}