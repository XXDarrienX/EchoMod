namespace = vb_psi_vortex

#Creation of the country
event = {
	id = vb_psi_vortex.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		create_country = {
			name = "Bleak Vortex"
			type = vb_psi_bleak_vortex
			flag = {
				icon = {
					category = "human"
					file = "flag_human_1.dds"
				}
				background = {
					category = "backgrounds"
					file = "circle.dds"
				}
				colors ={
					"blue"
					"black"
					"null"
					"null"
				}
			}
		}
		last_created_country = {
			save_event_target_as = vortex
		}
		random_country = {
			limit = { is_country_type = global_event }
			country_event = { id = vb_psi_vortex.2 days = 1 }
		}
		
	}
}

#Contact on day 2
country_event = {
	id = vb_psi_vortex.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		# random_country = {
			# limit = { is_country_type = vb_psi_bleak_vortex }
			# save_event_target_as = vortex
		# }
		every_country = {
			limit = { has_civic = civic_vb_psi_soul_eater }
			establish_communications_no_message = event_target:vortex
		}
	}
}

#Vortex lobby
country_event = {
	id = vb_psi_vortex.3
	title = VB_PSI_BLEAK_VORTEX_TITLE
	desc = vb_psi_vortex.3.desc
	
	is_triggered_only = yes
	diplomatic = yes
	force_open = yes
	
	picture_event_data = {
		portrait = shroud1
		room = shroud_room
	}
	
	trigger = {
		FROM = { is_country_type = vb_psi_bleak_vortex }
		NOT = { has_country_flag = vb_psi_vortex_diplo }
	}
	
	immediate = {
		set_country_flag = vb_psi_vortex_diplo
	}
	
	after = {
		remove_country_flag = vb_psi_vortex_diplo
	}
	
	#Exit, at the top
	option = {
		name = vb_psi_vortex.3.q
	}
	
	#Trade sustenance for resources
	option = {
		name = vb_psi_vortex.3.b
		custom_tooltip = vb_psi_vortex.3.b.tooltip
		allow = {
			custom_tooltip = {
				fail_text = vb_psi_vortex.recently_petitioned
				NOT = { has_modifier = vb_psi_petitioned_vortex }
			}
		}
		
		hidden_effect = {
			add_modifier = {
				modifier = vb_psi_petitioned_vortex
				days = 1800
			}
		}
		
		add_modifier = {
			modifier = vb_psi_vortex_boon
			days = 720
		}
	}
}