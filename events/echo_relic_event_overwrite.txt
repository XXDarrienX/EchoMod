namespace = ancrel

# Pilgrim Fleet
country_event = {
	id = ancrel.6132
	title = TRANSMISSION
	desc = "ancrel.6132.a.desc"
	desc = "ancrel.6132.b.desc"
	desc = "ancrel.6132.c.desc"
	desc = "ancrel.6132.d.desc"
	
	diplomatic = yes
	
	is_triggered_only = yes
	
	picture_event_data = {
		portrait = event_target:spiritualist_fallen_empire
		room = "ethic_spaceship_room"
	}
	
	option = {
		name = ancrel.6132.a
		hidden_effect = {
			capital_scope = {
				create_fleet = {
					name = "NAME_Zarqlans_Pilgrims"
					settings = {
						spawn_debris = no
					}
					effect = {
						set_owner = event_target:spiritualist_fallen_empire # For ship names
						while = {
							count = 1
							create_fallen_empire_large_ship = yes
						}
						while = {
							count = 3
							create_fallen_empire_small_ship = yes
						}
						set_location = {
							target = prev
							distance = 45
							angle = random
						}
						set_owner = root
						add_modifier = {
							modifier = echo_Scion_balance
							days = -1
						}
					}
				}
			}
		}
	}
}

# Spawning Event (HIDDEN)
event = {
	id = ancrel.6098
	hide_window = yes
	
	is_triggered_only = yes

	trigger = {
		mid_game_years_passed >= 20
		has_ancrel = yes
		is_multiplayer = no
		NOT = { has_global_flag = zarqlan_spawned }
		any_country = {
			OR = {
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
			}
			has_country_flag = fallen_empire_2
			any_playable_country = {
				is_ai = no
				has_communications = prev
			}
		}
	}

	immediate = {
		random_list = {
			100 = {}
			5 = {
				set_global_flag = zarqlan_spawned
				random_country = {
					limit = {
						OR = {
							is_country_type = fallen_empire
							is_country_type = awakened_fallen_empire
						}
						has_country_flag = fallen_empire_2
					}
					save_event_target_as = spiritualist_fallen_empire
				}
				random_playable_country = {
					limit = {
						is_ai = no
						has_communications = event_target:spiritualist_fallen_empire
					}
					country_event = { id = ancrel.6099 days = 1 random = 350 }
				}
			}
		}
	}
}