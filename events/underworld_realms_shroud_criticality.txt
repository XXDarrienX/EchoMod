############################
#
# The Shroud rises...
#
# Tiers :
# - Mild
# - Calm
# - Stirring
# - Restless
# - Stormy
# - Unleashed
# - Overwhelming
# - Cataclysmic
# 
############################

namespace = shroud_criticality

# Yearly decrease...
event = {
	id = shroud_criticality.0
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = { country_event = { id = shroud_criticality.2 days = 180 random = 180 } }
	}
}

# Loader
country_event = {
	id = shroud_criticality.1
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {
			if = {
				limit = {
					has_country_flag = shroud_lvl_1
				}
				
				if = {
					limit = {
						has_country_flag = shroud_lvl_2
					}
					
					if = {
						limit = {
							has_country_flag = shroud_lvl_3
						}
						
						if = {
							limit = {
								has_country_flag = shroud_lvl_4
							}
							
							if = {
								limit = {
									has_country_flag = shroud_lvl_5
								}
								
								if = {
									limit = {
										has_country_flag = shroud_lvl_6
									}
									
									if = {
										limit = {
											has_country_flag = shroud_lvl_7
										}
										
										set_country_flag = shroud_lvl_8
									}
								
									else = {
										set_country_flag = shroud_lvl_7
									}
								}
							
								else = {
									set_country_flag = shroud_lvl_6
								}
							}
						
							else = {
								set_country_flag = shroud_lvl_5
							}
						}
						
						else = {
							set_country_flag = shroud_lvl_4
						}
					}
					
					else = {
						set_country_flag = shroud_lvl_3
					}
				}
				
				else = {
					set_country_flag = shroud_lvl_2
				}
			}
			
			else = {
				set_country_flag = shroud_lvl_1
			}
		}
	}
}

# Unloader
country_event = {
	id = shroud_criticality.2
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {	
			if = {
				limit = {
					NOT = { has_country_flag = shroud_lvl_8 }
				}
				
				if = {
					limit = {
						NOT = { has_country_flag = shroud_lvl_7 }
					}
					
					if = {
						limit = {
							NOT = { has_country_flag = shroud_lvl_6 }
						}
						
						if = {
							limit = {
								NOT = { has_country_flag = shroud_lvl_5 }
							}
							
							if = {
								limit = {
									NOT = { has_country_flag = shroud_lvl_4 }
								}
								
								if = {
									limit = {
										NOT = { has_country_flag = shroud_lvl_3 }
									}
									
									remove_country_flag = shroud_lvl_2
								}
								
								else = {
									remove_country_flag = shroud_lvl_3
								}
							}
							
							else = {
								remove_country_flag = shroud_lvl_4
							}
						}
						
						else = {
							remove_country_flag = shroud_lvl_5
						}
					}
					
					else = {
						remove_country_flag = shroud_lvl_6
					}
				}
				
				else = {
					remove_country_flag = shroud_lvl_7
				}
			}
			
			else = {
				remove_country_flag = shroud_lvl_8
			}
			
			if = {
				limit = {
					NOT = { has_country_flag = shroud_lvl_1 }
				}
				
				set_country_flag = shroud_lvl_1
			}
		}
	}
}

# Consult the Shroud state
country_event = {
	id = shroud_criticality.3
	#title = shroud_criticality.3.name
	#desc = shroud_criticality.3.desc
	#picture = GFX_evt_psionics
	#show_sound = event_mystic_reveal
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_8 }
			}
			
			country_event = { id = shroud_criticality.11 }
		}
		
		else_if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_7	}
			}
			
			country_event = { id = shroud_criticality.10 }
		}
		
		else_if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_6	}
			}
			
			country_event = { id = shroud_criticality.9 }
		}
		
		else_if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_5 }
			}
			
			country_event = { id = shroud_criticality.8 }
		}
		
		else_if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_4 }
			}
			
			country_event = { id = shroud_criticality.7 }
		}
		
		else_if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_3 }
			}
			
			country_event = { id = shroud_criticality.6 }
		}
		
		else_if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_2 }
			}
			
			country_event = { id = shroud_criticality.5 }
		}
		
		else_if = {
			limit = {
				event_target:shroud_country = { has_country_flag = shroud_lvl_1 }
			}
			
			country_event = { id = shroud_criticality.4 }
		}
		
		else = {
			log = "No condition was found"
		}
	}
}

country_event = {
	id = shroud_criticality.4
	title = shroud_criticality.4.name
	desc = shroud_criticality.4.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.good.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.good.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.good.psionic
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.good.dark_side
	}
}

country_event = {
	id = shroud_criticality.5
	title = shroud_criticality.5.name
	desc = shroud_criticality.5.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		name = shroud_criticality.good.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.good.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.good.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.good.psionic
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.good.dark_side
	}
}

country_event = {
	id = shroud_criticality.6
	title = shroud_criticality.6.name
	desc = shroud_criticality.6.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.good.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.good.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.good.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.good.psionic
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.good.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.good.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.good.dark_side
	}
}

country_event = {
	id = shroud_criticality.7
	title = shroud_criticality.7.name
	desc = shroud_criticality.7.desc
	picture = GFX_evt_my_shroud
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.neutral.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.neutral.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.neutral.psionic
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.neutral.dark_side
	}
}

country_event = {
	id = shroud_criticality.8
	title = shroud_criticality.8.name
	desc = shroud_criticality.8.desc
	picture = GFX_evt_my_shroud
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.neutral.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.neutral.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.neutral.psionic
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.neutral.dark_side
	}
}

country_event = {
	id = shroud_criticality.9
	title = shroud_criticality.9.name
	desc = shroud_criticality.9.desc
	picture = GFX_evt_my_shroud
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.neutral.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.neutral.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.neutral.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.neutral.psionic
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.neutral.dark_side
	}
}

country_event = {
	id = shroud_criticality.10
	title = shroud_criticality.10.name
	desc = shroud_criticality.10.desc
	picture = GFX_evt_my_shroud
	show_sound = event_screams
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.bad.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.bad.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.bad.psionic
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.bad.dark_side
	}
}

country_event = {
	id = shroud_criticality.11
	title = shroud_criticality.11.name
	desc = shroud_criticality.11.desc
	picture = GFX_evt_my_shroud
	show_sound = event_screams
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_militarist
					has_ethic = ethic_fanatic_militarist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.militarist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.spiritualist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.authoritarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.xenophile
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.pacifist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_materialist
					has_ethic = ethic_fanatic_materialist
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.materialist
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.egalitarian
	}
	
	option = {
		trigger = {
			AND = {
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		name = shroud_criticality.bad.xenophobe
	}
	
	option = {
		trigger = {
			has_authority = auth_hive_mind
		}
		name = shroud_criticality.bad.gestalt_bio
	}
	
	option = {
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		name = shroud_criticality.bad.gestalt_mech
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_country_flag = dark_side }
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.bad.psionic
	}
	
	option = {
		trigger = {
			AND = {
				has_country_flag = dark_side
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		name = shroud_criticality.bad.dark_side
	}
}


# Silently convert pops into psykers
event = {
	id = shroud_criticality.15
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		if = {
			limit = {
				event_target:shroud_country = {
					OR = {
						has_country_flag = shroud_lvl_3
						has_country_flag = shroud_lvl_4
						has_country_flag = shroud_lvl_5
						has_country_flag = shroud_lvl_6
						has_country_flag = shroud_lvl_7
						has_country_flag = shroud_lvl_8
					}
				}
			}
			
			every_country = {
				limit = {
					is_country_type = default
					NOT = { has_country_flag = dark_side }
					NOT = {
						OR = {
							is_country_type = awakened_fallen_empire
							is_country_type = fallen_empire
						}
					}
					NOT = { has_policy_flag = psykers_outlawed }
				}
						
				if = {
					limit = {
						has_policy_flag = psykers_outlawed
					}
					
					random_list = {
						50 = {}
						50 = { country_event = { id = shroud_criticality.16 days = 180 random = 180 } }
					}
				}
				
				else = {
					 country_event = { id = shroud_criticality.16 }
				}
			}
		}
	}
}

# Pop event to psyker them
country_event = {
	id = shroud_criticality.16
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {
			if = {
				limit = { has_country_flag = shroud_lvl_8 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								120 = {}
								80 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_7 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								130 = {}
								70 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_6 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								140 = {}
								60 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_5 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								150 = {}
								50 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_4 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								160 = {}
								40 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_3 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								170 = {}
								30 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_2 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								180 = {}
								20 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_1 }
				root = {
					every_owned_planet = {
						every_owned_pop = {
							limit = {
								NOT = { has_trait = trait_psionic }
								NOT = { has_trait = trait_latent_psionic }
								NOT = { has_trait = trait_hive_mind }
								NOT = { has_trait = trait_mechanical }
								NOT = { has_trait = trait_machine_unit }
							}
							
							random_list = {
								190 = {}
								10 = {
									modify_species = {
										species = this
										add_trait = trait_latent_psionic
										add_traits_at_start_of_list = yes
									}
									random_list = {
										50 = {}
										50 = { pop_change_ethic = ethic_spiritualist }
									}
								}
							}
						}
					}
				}
			}
			
			else = {}
		}
	}
}

# Convert LEADERS into psyker
event = {
	id = shroud_criticality.17
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = { 
			if = {
				limit = { has_country_flag = shroud_lvl_8 }
				
				random_list = {
					80 = {}
					80 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_7 }
				
				random_list = {
					90 = {}
					70 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_6 }
				
				random_list = {
					100 = {}
					60 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_5 }
				
				random_list = {
					110 = {}
					50 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_4 }
				
				random_list = {
					120 = {}
					40 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_3 }
				
				random_list = {
					130 = {}
					30 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
			
			else_if = {
				limit = {has_country_flag = shroud_lvl_2 }
				
				random_list = {
					140 = {}
					20 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
			
			else_if = {
				limit = { has_country_flag = shroud_lvl_1 }
				
				random_list = {
					150 = {}
					10 = {
						country_event = { id = shroud_criticality.18 days = 180 random = 180 }
					}
				}
			}
		}
	}
}

# Event to psyker the leader
country_event = {
	id = shroud_criticality.18
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				NOT = { has_ascension_perk = ap_transcendence }
				NOT = { has_authority = auth_hive_mind }
				has_country_flag = psykers_detected
			}
			
			random_owned_leader = {
				limit = {
					NOT = {
						OR = {
							has_trait = "leader_trait_admiral_psionic"
							has_trait = "leader_trait_general_psionic"
							has_trait = "leader_trait_governor_psionic"
							has_trait = "leader_trait_scientist_psionic"
						}
					}
					NOT = { leader_class = ruler }
				}
				
				save_event_target_as = my_psychic_leader
				
				if = {
					limit = { leader_class = admiral }
					add_trait = leader_trait_admiral_psionic
				}
				else_if = {
					limit = { leader_class = general }
					add_trait = leader_trait_general_psionic
				}
				else_if = {
					limit = { leader_class = scientist }
					add_trait = leader_trait_scientist_psionic
				}
				else_if = {
					limit = { leader_class = governor }
					add_trait = leader_trait_governor_psionic
				}
				
				else = {}
				
				owner = { set_country_flag = psyker_leader }
			}
			
			if = {
				limit = {
					has_country_flag = psyker_leader
				}
				
				remove_country_flag = psyker_leader
				country_event = { id = shroud_criticality.19 }
			}
		}
	}
}

# Notify empire for his new leader
country_event = {
	id = shroud_criticality.19
	title = shroud_criticality.19.name
	desc = shroud_criticality.19.desc
	picture = GFX_evt_zro_2
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
			NOT = { has_policy_flag = psykers_outlawed }
		}
		
		name = shroud_criticality.19.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
			has_policy_flag = psykers_outlawed
		}
		
		event_target:my_psychic_leader = {
			if = {
				limit = { leader_class = admiral }
				remove_trait = leader_trait_admiral_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = general }
				remove_trait = leader_trait_general_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = scientist }
				remove_trait = leader_trait_scientist_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = governor }
				remove_trait = leader_trait_governor_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
		}
		
		name = shroud_criticality.19.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
			NOT = { has_policy_flag = psykers_outlawed }
		}
		
		name = shroud_criticality.19.c
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
			has_policy_flag = psykers_outlawed
		}
		
		event_target:my_psychic_leader = {
			if = {
				limit = { leader_class = admiral }
				remove_trait = leader_trait_admiral_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = general }
				remove_trait = leader_trait_general_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = scientist }
				remove_trait = leader_trait_scientist_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = governor }
				remove_trait = leader_trait_governor_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
		}
		
		name = shroud_criticality.19.d
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
			NOT = { has_policy_flag = psykers_outlawed }
		}
		
		name = shroud_criticality.19.e
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
			has_policy_flag = psykers_outlawed
		}
		
		event_target:my_psychic_leader = {
			if = {
				limit = { leader_class = admiral }
				remove_trait = leader_trait_admiral_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = general }
				remove_trait = leader_trait_general_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = scientist }
				remove_trait = leader_trait_scientist_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
			if = {
				limit = { leader_class = governor }
				remove_trait = leader_trait_governor_psionic
				add_trait = "leader_trait_substance_abuser"
				break = yes
			}
		}
		
		name = shroud_criticality.19.f
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				AND = {
					NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
					NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
				}
				has_policy_flag = psykers_outlawed
			}
		}
		
		name = shroud_criticality.19.g
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				AND = {
					NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
					NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
				}
				NOT = { has_policy_flag = psykers_outlawed }
			}
		}
		
		name = shroud_criticality.19.h
	}
}

# Selector
event = {
	id = shroud_criticality.20
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		AND = {
			host_has_dlc = "Utopia"
			host_has_dlc = "Apocalypse"
			host_has_dlc = "Megacorp"
			host_has_dlc = "Federations"
		}
	}
	
	immediate = {
		log = "Shroud Selector Triggered"
		if = {
			limit = {
				any_country = {
					has_country_flag = psykers_detected
				}
			}
			
			every_country = {
				limit = {
					is_country_type = shroud
				}
				
				save_event_target_as = shroud_country
			}
			
			if = {
				limit = {
					event_target:shroud_country = { has_country_flag = shroud_lvl_8 }
				}
				
				log = "Tier 4"
				
				event_target:shroud_country = { country_event = { id = shroud_criticality.24 } }
			}
			
			else_if = {
				limit = {
					OR = {
						event_target:shroud_country = { has_country_flag = shroud_lvl_7 }
						event_target:shroud_country = { has_country_flag = shroud_lvl_6 }
					}
				}
				
				log = "Tier 3"
				
				event_target:shroud_country = { country_event = { id = shroud_criticality.23 } }
			}
			
			else_if = {
				limit = {
					OR = {
						event_target:shroud_country = { has_country_flag = shroud_lvl_5 }
						event_target:shroud_country = { has_country_flag = shroud_lvl_4 }
					}
				}
				
				log = "Tier 2"
				
				event_target:shroud_country = { country_event = { id = shroud_criticality.22 } }
			}
			
			else_if = {
				limit = {
					OR = {
						event_target:shroud_country = { has_country_flag = shroud_lvl_3 }
						event_target:shroud_country = { has_country_flag = shroud_lvl_2 }
					}
				}
				
				log = "Tier 1"
				
				event_target:shroud_country = { country_event = { id = shroud_criticality.21 } }
			}
		}
	}
}

### Tiers 1 events ###

# Tiers 1 selector
country_event = {
	id = shroud_criticality.21
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		
		random_list = {
			50 = {} # Do Nothing
			50 = {
				random_list = {
					150 = { root = { country_event = { id = shroud_criticality.1100 } } } # Boons
					50 = { root = { country_event = { id = shroud_criticality.100 } } } # Avatar
					0 = { root = { country_event = { id = shroud_criticality.110 } } } # FTL mess
					50 = { root = { country_event = { id = shroud_criticality.130 } } } # Horrors of the Warp (Generic) OR Warn country about Psykers
					0 = { root = { country_event = { id = shroud_criticality.200} } } # Instrument of Desire Curse
					0 = { root = { country_event = { id = shroud_criticality.300 } } } # Composer of Strands Curse
					0 = { root = { country_event = { id = shroud_criticality.400 } } } # Void Whisperer Curse
					0 = { root = { country_event = { id = shroud_criticality.500 } } } # Eater of Worlds Curse
					0 = { root = { country_event = { id = shroud_criticality.1000 } } } # End of the Cyle
				}
			}
		}
	}
}

# Tiers 2 selector
country_event = {
	id = shroud_criticality.22
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		
		random_list = {
			50 = {} # Do Nothing
			50 = {
				random_list = {
					100 = { root = { country_event = { id = shroud_criticality.1100 } } } # Boons
					30 = { root = { country_event = { id = shroud_criticality.100 } } } # Avatar
					0 = { root = { country_event = { id = shroud_criticality.110 } } } # FTL mess
					30 = { root = { country_event = { id = shroud_criticality.130 } } } # Horrors of the Warp (Generic) OR Warn country about Psykers
					10 = { root = { country_event = { id = shroud_criticality.200 } } } # Instrument of Desire Curse
					10 = { root = { country_event = { id = shroud_criticality.300 } } } # Composer of Strands Curse
					10 = { root = { country_event = { id = shroud_criticality.400 } } } # Void Whisperer Curse
					10 = { root = { country_event = { id = shroud_criticality.500 } } } # Eater of Worlds Curse
					0 = { root = { country_event = { id = shroud_criticality.1000 } } } # End of the Cyle
				}
			}
		}
	}
}

# Tiers 3 selector
country_event = {
	id = shroud_criticality.23
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		
		random_list = {
			50 = {} # Do Nothing
			50 = {
				random_list = {
					35 = { root = { country_event = { id = shroud_criticality.1100 } } } # Boons
					25 = { root = { country_event = { id = shroud_criticality.100 } } } # Avatar
					0 = { root = { country_event = { id = shroud_criticality.110 } } } # FTL mess
					25 = { root = { country_event = { id = shroud_criticality.130 } } } # Horrors of the Warp (Generic) OR Warn country about Psykers
					15 = { root = { country_event = { id = shroud_criticality.200 } } } # Instrument of Desire Curse
					15 = { root = { country_event = { id = shroud_criticality.300 } } } # Composer of Strands Curse
					15 = { root = { country_event = { id = shroud_criticality.400 } } } # Void Whisperer Curse
					15 = { root = { country_event = { id = shroud_criticality.500 } } } # Eater of Worlds Curse
					0 = { root = { country_event = { id = shroud_criticality.1000 } } } # End of the Cyle
				}
			}
		}
	}
}

# Tiers 4 selector
country_event = {
	id = shroud_criticality.24
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		Log = "Tier 4 OK"
		random_list = {
			20 = { root = { country_event = { id = shroud_criticality.1100 } } } # Boons
			20 = { root = { country_event = { id = shroud_criticality.100 } } } # Avatar
			0 = { root = { country_event = { id = shroud_criticality.110 } } } # FTL mess
			50 = { root = { country_event = { id = shroud_criticality.130 } } } # Horrors of the Warp (Generic) OR Warn country about Psykers
			50 = { root = { country_event = { id = shroud_criticality.200 } } } # Instrument of Desire Curse
			50 = { root = { country_event = { id = shroud_criticality.300 } } } # Composer of Strands Curse
			50 = { root = { country_event = { id = shroud_criticality.400 } } } # Void Whisperer Curse
			50 = { root = { country_event = { id = shroud_criticality.500 } } } # Eater of Worlds Curse
			100 = { root = { country_event = { id = shroud_criticality.1000 } } } # End of the Cyle
		}
	}
}

### Events ###

# I) Avatar
country_event = {
	id = shroud_criticality.100
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
	
		Log = "Avatar"
		
		random_system = {
			limit = {
				exists = starbase
				starbase = { owner = { is_country_type = default } }
			}
			save_event_target_as = system_avatar
			starbase = { owner = { save_event_target_as = poor_victim } }
			
			if = {
				limit = {
					event_target:poor_victim = { has_country_flag = dark_side }
				}
				
				event_target:poor_victim = { country_event = { id = shroud_criticality.104 } }
			}
			else = {
				root = { country_event = { id = shroud_criticality.101 } }
			}
		}
	}
}

# Summon Corrupted Avatar....
country_event = {
	id = shroud_criticality.101
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:system_avatar = {
			random_system_planet = { save_event_target_as = shroud_spawn_planet }
		}
		
		every_country = {
			limit = {
				is_country_type = shroud_spirits
			}
			
			save_event_target_as = shroud_spirits
		}
		
		event_target:poor_victim = { set_country_flag = poor_victim }
		
		event_target:shroud_spirits = {
			create_fleet = {
				name = "NAME_Corrupted_Avatar"
				settings = {
					spawn_debris = no
					is_boss = yes
				}			
				effect = {
					set_owner = event_target:shroud_spirits
					create_ship = {
						name = "NAME_Corrupted_Avatar"
						design = "NAME_Corrupted_Avatar"
					}
					set_location = event_target:shroud_spawn_planet
					set_fleet_stance = aggressive
					set_aggro_range_measure_from = return_point
					set_aggro_range = 300
				}
			}
		}
		
		observer_event = { id = shroud_criticality.5000 }
		
		last_created_fleet = { # Despawn if enough time passes without being destroyed
			fleet_event = { id = utopia.3025 days = 720 }
		}
		
		event_target:poor_victim = { country_event = { id = shroud_criticality.102 } }
		
		every_country = {
			limit = {
				is_ai = no
			}
			
			if = {
				limit = {
					NOT = { has_country_flag = poor_victim }
					has_communications = event_target:poor_victim
				}
				country_event = { id = shroud_criticality.103 }
			}
			
			else = {
				remove_country_flag = poor_victim
			}
		}
	}
}

# Hello there !
country_event = {
	id = shroud_criticality.102
	title = shroud_criticality.102.name
	desc = shroud_criticality.102.desc
	picture = GFX_evt_psionics
	show_sound = event_screams
	location = event_target:shroud_spawn_planet
	
	is_triggered_only = yes
	
	option = {	
		trigger = {
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		
		name = shroud_criticality.102.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.102.b
	}
}

# An empire has to fight a Corrupted Avatar :) !
country_event = {
	id = shroud_criticality.103
	title = shroud_criticality.103.name
	desc = shroud_criticality.103.desc
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	location = event_target:shroud_spawn_planet
	
	is_triggered_only = yes
	
	option = {	
		trigger = {
			AND = {
				NOT = { leader = { has_trait = leader_trait_ruler_psionic } }
				NOT = { leader = { has_trait = leader_trait_ruler_chosen } }
			}
		}
		
		name = shroud_criticality.103.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.103.b
	}
}

# Summon Corrupted Avatar, but for the Dark boy
country_event = {
	id = shroud_criticality.104
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:system_avatar = {
			random_system_planet = { save_event_target_as = shroud_spawn_planet }
		}
		
		every_country = {
			limit = {
				is_country_type = shroud_spirits
			}
			
			save_event_target_as = shroud_spirits
		}
		
		event_target:poor_victim = { set_country_flag = poor_victim }
		
		event_target:shroud_spirits = {
			create_fleet = {
				name = "NAME_Corrupted_Avatar"
				settings = {
					spawn_debris = no
					is_boss = yes
				}
				effect = {
					set_owner = event_target:poor_victim
					create_ship = {
						name = "NAME_Corrupted_Avatar"
						design = "NAME_Corrupted_Avatar"
					}
					set_location = event_target:shroud_spawn_planet
				}
			}
		}
		
		event_target:poor_victim = { country_event = { id = shroud_criticality.105 } }
		
		event_target:poor_victim = {			
			if = {
				limit = {
					NOT = { has_country_flag = poor_victim }
				}
				country_event = { id = shroud_criticality.105 }
			}
			
			else = {
				remove_country_flag = poor_victim
			}
		}
	}
}

# Yes Master...
country_event = {
	id = shroud_criticality.105
	title = shroud_criticality.105.name
	desc = shroud_criticality.105.desc
	picture = GFX_evt_psionics
	show_sound = event_bad_omen
	location = event_target:shroud_spawn_planet
	
	is_triggered_only = yes
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.105.a
	}
}

# II) FTL messing
country_event = {
	id = shroud_criticality.110
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
	
		Log = "FTL Mess"
		
		every_country = {
			limit = {
				is_country_type = default
			}
		
			if = {
				limit = {
					has_country_flag = dark_side
				}
			
				country_event = { id = shroud_criticality.112 }
			}
			
			else = {
				if = {
					limit = {
						has_modifier = ftl_disturbance
					}
					
					remove_modifier = ftl_disturbance
				}
				
				add_modifier = { modifier = "ftl_disturbance" days = 720 }
				country_event = { id = shroud_criticality.111 }
			}
		}
		
		observer_event = { id = shroud_criticality.5001 }
	}
}

# Warn virgin people
country_event = {
	id = shroud_criticality.111
	title = shroud_criticality.111.name
	desc = shroud_criticality.111.desc
	picture = GFX_evt_wormhole
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.111.a
	}
	
	option = {	
		trigger = {
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.111.b
	}
}

# Warn the chad chaotic bois
country_event = {
	id = shroud_criticality.112
	title = shroud_criticality.112.name
	desc = shroud_criticality.112.desc
	picture = GFX_evt_wormhole
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.111.a
	}
}

# What kind of bad thing will happen to this fleet ?
fleet_event = {
	id = shroud_criticality.113
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				OR = {
					owner = { has_modifier = ftl_disturbance }
					owner = { has_country_flag = dark_side }
				}
			}
			
			random_list = {
				35 = {} # Do Nothing
				20 = { fleet_event = { id = shroud_criticality.127 } } # Displacement !
				15 = { fleet_event = { id = shroud_criticality.114 } } # Freeze Movement
				15 = { fleet_event = { id = shroud_criticality.118 } } # Bad thing to fleet leader
				10 = { fleet_event = { id = shroud_criticality.122 } } # Loose ships
				5 = { fleet_event = { id = shroud_criticality.124 } }  # Loose fleet to Shroud
			}
		}
	}
}

# Lock the fleet
fleet_event = {
	id = shroud_criticality.114
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				NOT = { owner = { has_country_flag = dark_side } }
			}
			
			clear_orders = yes
			
			set_event_locked = yes
			save_event_target_as = my_fleet
			
			random_list = {
				40 = { fleet_event = { id = shroud_criticality.115 days = 180 } }
				30 = { fleet_event = { id = shroud_criticality.115 days = 360 } }
				20 = { fleet_event = { id = shroud_criticality.115 days = 720 } }
				10 = { fleet_event = { id = shroud_criticality.115 days = 1800 } }
				2 = { fleet_event = { id = shroud_criticality.115 days = 3600 } }
			}
			
			owner = { country_event = { id = shroud_criticality.116 } }
		}
		
		else = {
			fleet_event = { id = shroud_criticality.127 }
		}
	}
}

# Unlock the fleet
fleet_event = {
	id = shroud_criticality.115
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_event_locked = no
		
		save_event_target_as = my_fleet
		
		owner = { country_event = { id = shroud_criticality.117 } }
	}
}

# Warn Owner
country_event = {
	id = shroud_criticality.116
	title = shroud_criticality.116.name
	desc = shroud_criticality.116.desc
	picture = GFX_evt_wormhole
	show_sound = event_bad_omen
	location = event_target:my_fleet
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.116.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.116.b
	}
}

# Resume orders and warn Owner
country_event = {
	id = shroud_criticality.117
	title = shroud_criticality.117.name
	desc = shroud_criticality.117.desc
	picture = GFX_evt_wormhole
	location = event_target:my_fleet
	
	is_triggered_only = yes
	
	option = {
		name = shroud_criticality.117.a
	}
}

# Admiral/Scientist dies... or become mad...
fleet_event = {
	id = shroud_criticality.118
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = my_fleet
		
		log = "118"
		
		if = {
			limit = {
				exists = leader
			}
			if = {
				limit = {
					owner = { NOT = { has_country_flag = dark_side } }
				}
				
				random_list = {
					66 = {
						if = {
							limit = {
								leader = { leader_class = scientist }
							}
							
							leader = {
								if = {
									limit = {
										has_trait = leader_trait_paranoid
									}
									
									save_event_target_as = old_fleet_leader
									
									owner = { country_event = { id = shroud_criticality.120 } }
								}
								
								else = {
									add_trait = leader_trait_paranoid
									
									owner = { country_event = { id = shroud_criticality.119 } }
								}
							}
						}
						
						else_if = {
							limit = {
								leader = { leader_class = admiral }
							}
							
							leader = {
								if = {
									limit = {
										AND = {
											has_trait = leader_trait_nervous
											has_trait = leader_trait_lethargic
										}
									}
									
									save_event_target_as = old_fleet_leader
									
									owner = { country_event = { id = shroud_criticality.120 } }
								}
								
								else_if = {
									limit = {
										has_trait = leader_trait_nervous
									}
									
									add_trait = leader_trait_lethargic
									
									owner = { country_event = { id = shroud_criticality.119 } }
								}
								
								else_if = {
									limit = {
										has_trait = leader_trait_lethargic
									}
									
									add_trait = leader_trait_nervous
									
									owner = { country_event = { id = shroud_criticality.119 } }
								}
								
								else = {
									random_list = {
										50 = { add_trait = leader_trait_nervous }
										50 = { add_trait = leader_trait_lethargic }
									}
									
									owner = { country_event = { id = shroud_criticality.119 } }
								}
							}
						}
						
						else = {
							limit = {
								leader = { leader_class = admiral }
							}
							
							leader = {
								if = {
									limit = {
										has_trait = leader_trait_armchair_commander
									}
									
									save_event_target_as = old_fleet_leader
									
									owner = { country_event = { id = shroud_criticality.120 } }
								}
								
								else_if = {
									limit = {
										has_trait = leader_trait_armchair_commander
									}
									
									add_trait = leader_trait_armchair_commander
									
									owner = { country_event = { id = shroud_criticality.119 } }
								}
							}
						}
					}
					33 = {
						leader = { save_event_target_as = old_fleet_leader }
						
						owner = { country_event = { id = shroud_criticality.120 } }
					}
				}
			}
			
			else_if = {
				limit = {
					owner = { has_country_flag = dark_side }
				}
				
				if = {
					limit = {
						leader = { has_leader_flag = has_gained_level_trait }
					}
					
					leader = { set_leader_flag = dont_touch }
				}
				
				leader = { owner = { country_event = { id = leader.20 } } }
				
				if = {
					limit = {
						leader = { NOT = { has_leader_flag = dont_touch } }
					}
					
					leader = { remove_leader_flag = has_gained_level_trait }
				}
				
				else = {
					leader = { remove_leader_flag = dont_touch }
				}
				
				owner = { country_event = { id = shroud_criticality.121 } }
			}
		}
	}
}

# Admiral/Scientist/General have seen things...
country_event = {
	id = shroud_criticality.119
	title = shroud_criticality.119.name
	desc = shroud_criticality.119.desc
	picture = GFX_evt_surreal_visions
	location = event_target:my_fleet
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.119.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.119.b
	}
}

# Admiral/Scientist/General died... lol
country_event = {
	id = shroud_criticality.120
	title = shroud_criticality.120.name
	desc = shroud_criticality.120.desc
	picture = GFX_evt_surreal_visions
	location = event_target:my_fleet
	show_sound = event_screams
	
	is_triggered_only = yes
	
	immediate = {
		event_target:old_fleet_leader = { kill_leader = { show_notification = no } }
	}
	
	option = {
		trigger = {
			NOT = {
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.120.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.120.b
	}
}

# Admiral/Scientist/General gains a trait, cause chad dark sider
country_event = {
	id = shroud_criticality.121
	title = shroud_criticality.121.name
	desc = shroud_criticality.121.desc
	picture = GFX_evt_surreal_visions
	location = event_target:my_fleet
	show_sound = event_the_great_awakening
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.121.a
	}
}

# Loose some ships...
fleet_event = {
	id = shroud_criticality.122
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		log = "122"
		save_event_target_as = my_fleet
		
		if = {
			limit = {
				owner = { has_country_flag = dark_side }
			}
			
			fleet_event = { id = shroud_criticality.118 }
		}
			
		else = {
			if = {
				limit = {
					num_ships > 1
				}
				
				every_ship = {
					random_list = {
						66 = {}
						33 = { destroy_ship = this }
					}
				}
				
				owner = { country_event = { id = shroud_criticality.123 } }
			}
			
			else = {
				fleet_event = { id = shroud_criticality.124 }
			}
		}
	}
}

# Destroy Ship
country_event = {
	id = shroud_criticality.123
	title = shroud_criticality.123.name
	desc = shroud_criticality.123.desc
	picture = GFX_evt_sabotaged_ship
	location = event_target:my_fleet
	show_sound = event_screams
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.123.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.123.b
	}
}

# Loose entire fleet...
fleet_event = {
	id = shroud_criticality.124
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		log = "124"
		save_event_target_as = my_fleet
		
		if = {
			limit = {
				OR = {
					NOT = { owner = { has_country_flag = dark_side } }
					has_fleet_flag = tribute_to_the_shroud
				}
			}
			
			if = {
				limit = {
					NOT = { owner = { has_country_flag = dark_side } }
				}
				
				owner = { country_event = { id = shroud_criticality.125 } }
			}
			
			else = {
				owner = { country_event = { id = shroud_criticality.126 } }
			}
		}
			
		else = {
			random_list = {
				66 = {}
				23 = {
					fleet_event = { id = shroud_criticality.127 }
				}
				11 = {
					set_fleet_flag = tribute_to_the_shroud
					
					fleet_event = { id = shroud_criticality.124 }
				}
			}
		}
	}
}

# You loose your fleet... (Normal guy)
country_event = {
	id = shroud_criticality.125
	title = shroud_criticality.125.name
	desc = shroud_criticality.125.desc
	picture = GFX_evt_sabotaged_ship
	location = event_target:my_fleet
	show_sound = event_screams
	
	is_triggered_only = yes
	
	immediate = {
		delete_fleet = event_target:my_fleet
	}
	
	option = {
		trigger = {
			NOT = {
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.125.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.125.b
	}
}

# You loose your fleet... (Chad Dark Sider)
country_event = {
	id = shroud_criticality.126
	title = shroud_criticality.126.name
	desc = shroud_criticality.126.desc
	picture = GFX_evt_unspeakable_horror
	location = event_target:my_fleet
	show_sound = event_screams
	
	is_triggered_only = yes
	
	immediate = {
		delete_fleet = event_target:my_fleet
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.126.a
	}
}

# Displacement !
fleet_event = {
	id = shroud_criticality.127
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		log = "127"
		save_event_target_as = my_fleet
	
		closest_system = {
			limit = {
				has_access_fleet = root.owner
			}
			min_steps = 3
			max_steps = 10
			
			random_system_planet = {
				save_event_target_as = my_random_location
			}
		}
		
		set_location = event_target:my_random_location
		
		if = {
			limit = {
				NOT = { owner = { has_country_flag = dark_side } }
			}
			
			owner = { country_event = { id = shroud_criticality.128 } }
		}
		
		else = {
			owner = { country_event = { id = shroud_criticality.129 } }
		}
	}
}

# Displacement (Normal guy)
country_event = {
	id = shroud_criticality.128
	title = shroud_criticality.128.name
	desc = shroud_criticality.128.desc
	picture = GFX_evt_star_chart
	location = event_target:my_random_location
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = {
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.128.a
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.128.b
	}
}

# Displacement (Chad Dark Sider)
country_event = {
	id = shroud_criticality.129
	title = shroud_criticality.129.name
	desc = shroud_criticality.129.desc
	picture = GFX_evt_star_chart
	location = event_target:my_random_location
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.129.a
	}
}

# III) Psykers and Warp horrors

# Aware country that psionic pops exist
event = {
	id = shroud_criticality.130
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = default
			}
			
			if = {
				limit = {
					NOT = { has_country_flag = psykers_detected }
					any_owned_planet = {
						any_owned_pop = {
							OR = {
								has_trait = trait_latent_psionic
								has_trait = trait_psionic
							}
						}
					}
				}
				
				this = { set_country_flag = psykers_detected }
				
				this = { country_event = { id = shroud_criticality.131 days = 1 random = 1800 } }
			}
			
			else_if = {
				limit = {
					any_owned_planet = {
						any_owned_pop = {
							OR = {
								has_trait = trait_latent_psionic
								has_trait = trait_psionic
							}
						}
					}
					NOT = { has_country_flag = has_been_horrored }
				}
				
				random_list = {
					80 = {}
					20 = { this = { country_event = { id = shroud_criticality.132 days = 1 random = 360 } } }
				}
			}
			
			else_if = {
				limit = {
					any_owned_planet = {
						any_owned_pop = {
							OR = {
								has_trait = trait_latent_psionic
								has_trait = trait_psionic
							}
						}
					}
				}
				
				this = { country_event = { id = shroud_criticality.1101 days = 1 random = 360 } }
			}
			
			else = {}
		}
	}
}

# Psykers detected
country_event = {
	id = shroud_criticality.131
	title = shroud_criticality.131.name
	
	picture = GFX_evt_zro_2
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	desc = {
		trigger = {
			NOT = { has_ascension_perk = ap_transcendence }
		}
		
		text = shroud_criticality.131.desc
	}
	
	desc = {
		trigger = {
			has_ascension_perk = ap_transcendence
		}
		
		text = shroud_criticality.131.desc.psi
	}
	
	immediate = {
		save_event_target_as = observer_country_psykers
		observer_event = { id = shroud_criticality.5002 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = {
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.131.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.131.b
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.131.c
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.131.d
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.131.e
	}
}

# Warp Horrors - warn country
country_event = {
	id = shroud_criticality.132
	title = shroud_criticality.132.name
	desc = shroud_criticality.132.desc
	picture = GFX_evt_unspeakable_horror
	show_sound = event_screams
	
	is_triggered_only = yes
	
	immediate = {
		Log = "Warp Horrors"
		
		set_timed_country_flag = { flag = has_been_horrored days = 1800 }
		
		every_owned_planet = {
			every_owned_pop = {
				limit = {
					OR = {
						has_trait = trait_latent_psionic
						has_trait = trait_psionic
					}
					is_being_purged = no
				}
				
				this = { add_modifier = { modifier = pop_horrors_of_the_shroud days = 720 } }
			}
		}
		
		save_event_target_as = observer_country_horrors
		observer_event = { id = shroud_criticality.5003 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.132.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.132.b
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.132.c
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.132.d
	}
}

# Turn psykers into normal pop again if "Psykers Outlawed" policy is up
event = {
	id = shroud_criticality.133
	hide_window = yes
	
	is_triggered_only = yes

	immediate = {
		every_country = {
			limit = {
				has_policy_flag = psykers_outlawed
			}
			
			every_owned_pop = {
				limit = {
					OR = {
						has_trait = trait_latent_psionic
						has_trait = trait_psionic
					}
				}
				
				random_list = {
					20 = {}
					80 = {
						if {
							limit = {
								has_trait = trait_latent_psionic
							}
							
							modify_species = {
								species = this
								remove_trait = trait_latent_psionic
							}
						}
						
						if = {
							limit = {
								has_trait = trait_psionic
							}
							
							modify_species = {
								species = this
								remove_trait = trait_psionic
							}
						}
						
						this = { add_modifier = { modifier = pop_got_nerfed days = 360 } }
					}
				}
			}
		}
	}
}

# IV) Patrons' stuff

# Instrument of Desire
country_event = {
	id = shroud_criticality.200
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
	
		Log = "Instrument of Desire"
	
		every_country = {
			limit = {
				is_country_type = shroud
			}
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {
			if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_7
						has_country_flag = shroud_lvl_8
					}
				}
				
				country_event = { id = shroud_criticality.201 days = 180 random = 180 }
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_6
					}
				}
				
				country_event = { id = shroud_criticality.203 days = 180 random = 180 }
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_5
					}
				}
				
				country_event = { id = shroud_criticality.205 days = 180 random = 180 }
			}
			
			else = {}
		}
	}
}

# Instrument of Desire - Level 1
country_event = {
	id = shroud_criticality.201
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				any_owned_planet = {
					NOT = { has_modifier = instrument_curse_lv1 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
			}
			
			random_owned_planet = {
				limit = {
					NOT = { has_modifier = instrument_curse_lv1 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
				
				add_modifier = { modifier = instrument_curse_lv1 days = 3600 }
				 
				save_event_target_as = instru_cursed_planet
			}
			
			country_event = { id = shroud_criticality.202 }
		}
	}
}

# Instrument of Desire - Level 1 - Warn country
country_event = {
	id = shroud_criticality.202
	title = shroud_criticality.202.name
	desc = shroud_criticality.202.desc
	picture = GFX_evt_civil_action
	show_sound = event_planetary_riot
	location = event_target:instru_cursed_planet
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_instrument_lv1
		observer_event = { id = shroud_criticality.5004 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.202.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.202.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.202.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.202.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.202.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.202.f
	}
}

# Instrument of Desire - Level 2
country_event = {
	id = shroud_criticality.203
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				NOT = { has_ethic = ethic_gestalt_consciousness }
				any_owned_planet = {
					NOT = { has_modifier = instrument_curse_lv2 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
							
						}
						is_being_purged = no
					}
				}
			}
			
			random_owned_planet = {
				limit = {
					NOT = { has_modifier = instrument_curse_lv2 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
				
				add_modifier = { modifier = instrument_curse_lv2 days = 3600 }
				 
				save_event_target_as = instru_cursed_planet
			}
			
			country_event = { id = shroud_criticality.204 }
		}
	}
}

# Instrument of Desire - Level 2 - Warn country
country_event = {
	id = shroud_criticality.204
	title = shroud_criticality.204.name
	desc = shroud_criticality.204.desc
	picture = GFX_evt_rakdos
	show_sound = event_planetary_riot
	location = event_target:instru_cursed_planet
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_instrument_lv2
		observer_event = { id = shroud_criticality.5005 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.204.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.204.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.204.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.204.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.204.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.204.f
	}
}

# Instrument of Desire - Level Max
country_event = {
	id = shroud_criticality.205
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				OR = {
					NOT = { has_ethic = ethic_gestalt_consciousness }
					has_valid_civic = civic_machine_servitor
				}
				any_owned_planet = {
					NOT = { has_modifier = instrument_curse_lv3 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
			}
			
			random_owned_planet = {
				limit = {
					NOT = { has_modifier = instrument_curse_lv3 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
				
				add_modifier = { modifier = instrument_curse_lv3 days = 3600 }
				
				save_event_target_as = instru_cursed_planet
			}
			
			country_event = { id = shroud_criticality.206 }
		}
	}
}

# Instrument of Desire - Level Max - Warn country
country_event = {
	id = shroud_criticality.206
	title = shroud_criticality.206.name
	desc = shroud_criticality.206.desc
	picture = GFX_evt_unspeakable_horror
	show_sound = event_screams
	location = event_target:instru_cursed_planet
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_instrument_lv3
		observer_event = { id = shroud_criticality.5006 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.206.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.206.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.206.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.206.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.206.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.206.f
	}
}

# Composer of Strands
event = {
	id = shroud_criticality.300
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		
		Log = "Composer of Strands"
	
		every_country = {
			limit = {
				is_country_type = shroud
			}
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {
			if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_7
						has_country_flag = shroud_lvl_8
					}
				}
				
				random_list = {
					10 = {}
					90 = { country_event = { id = shroud_criticality.301 days = 180 random = 180 } }
				}
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_6
					}
				}
				
				random_list = {
					33 = {}
					66 = { country_event = { id = shroud_criticality.301 days = 180 random = 180 } }
				}
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_5
					}
				}
				
				random_list = {
					50 = {}
					50 = { country_event = { id = shroud_criticality.301 days = 180 random = 180 } }
				}
			}
			
			else = {}
		}
	}
}

# Composer of Strands - Level 1
country_event = {
	id = shroud_criticality.301
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				NOT = { has_country_flag = immune_to_composer_disease }
				any_owned_planet = {
					NOT = { has_modifier = composer_curse_lv1 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
			}
			
			random_owned_planet = {
				limit = {
					NOT = { has_modifier = composer_curse_lv1 }
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
				
				add_modifier = { modifier = composer_curse_lv1 days = 3600 }
				
				every_owned_pop = {
					limit = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				
					add_modifier = { modifier = pop_composer_disease days = 3600 }
				}
				 
				save_event_target_as = composer_cursed_planet
			}
			
			country_event = { id = shroud_criticality.302 }
			
			country_event = { id = shroud_criticality.305 days = 360 random = 360 }
		}
	}
}

# Composer of Strands - Level 1 - Warn country
country_event = {
	id = shroud_criticality.302
	title = shroud_criticality.302.name
	desc = shroud_criticality.302.desc
	picture = GFX_evt_disease_outbreak
	show_sound = event_screams
	location = event_target:composer_cursed_planet
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_composer_lv1
		observer_event = { id = shroud_criticality.5007 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.302.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.302.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.302.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.302.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.302.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.302.f
	}
}

# Composer of Strands - Curse spreading
event = {
	id = shroud_criticality.303
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			50 = {}
			50 = {
				every_playable_country = {
					limit = {
						is_country_type = default
						NOT = { has_country_flag = dark_side }
						NOT = {
							OR = {
								is_country_type = awakened_fallen_empire
								is_country_type = fallen_empire
							}
						}
						NOT = { has_country_flag = immune_to_composer_disease }
					}
					
					save_event_target_as = target_country
					
					every_owned_planet = {
						limit = {
							has_modifier = composer_curse_lv1
						}
						every_owned_pop = {
							limit = {
								is_lithoid = no
								is_being_purged = no
								NOT = { has_trait = trait_mechanical }
							}
							
							if = {
								limit = {
									has_modifier = pop_composer_disease
								}
								
								random_list = {
									90 = { }
									10 = {
										set_pop_flag = marked_for_death_composer
										
										event_target:target_country = {
											if = {
												limit = {
													NOT = { has_country_flag = lost_pop_to_disease }
												}
												
												set_country_flag = disease_hit
											}
										}
									}
								}
							}
							
							else = {
								random_list = {
									80 = { }
									20 = {
										add_modifier = { modifier = pop_composer_disease days = 3600 }
										
										event_target:target_country = {
											if = {
												limit = {
													NOT = { has_country_flag = lost_pop_to_disease }
												}
												
												set_country_flag = disease_hit
											}
										}
									}
								}
							}
						}
					}
					
					if = {
						limit = {
							has_country_flag = disease_hit
						}
						
						every_owned_planet = {
							limit = {
								NOT = { has_modifier = composer_curse_lv1 }
								any_owned_pop = {
									OR = {
										has_trait = trait_latent_psionic
										has_trait = trait_psionic
									}
									is_being_purged = no
								}
							}
							
							random_list = {
								60 = {}
								40 = {
									add_modifier = { modifier = composer_curse_lv1 days = 3600 }
									
									every_owned_pop = {
										limit = {
											OR = {
												has_trait = trait_latent_psionic
												has_trait = trait_psionic
											}
											is_being_purged = no
										}
									
										add_modifier = { modifier = pop_composer_disease days = 3600 }
									}
								}
							}
						}
					}
					
					if = {
						limit = {
							has_country_flag = disease_hit
						}
						
						remove_country_flag = disease_hit
						
						country_event = { id = shroud_criticality.304 }
					}
				}
			}
		}
	}
}

# Composer of Strands - Spreading - Warn country
country_event = {
	id = shroud_criticality.304
	title = shroud_criticality.304.name
	desc = shroud_criticality.304.desc
	picture = GFX_evt_disease_outbreak
	show_sound = event_screams
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_composer_lv1_spread
		observer_event = { id = shroud_criticality.5008 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		every_owned_pop = {
			limit = {
				has_pop_flag = marked_for_death_composer
			}
			
			kill_pop = yes
		}
		
		name = shroud_criticality.304.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		every_owned_pop = {
			limit = {
				has_pop_flag = marked_for_death_composer
			}
			
			kill_pop = yes
		}
		
		name = shroud_criticality.304.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		every_owned_pop = {
			limit = {
				has_pop_flag = marked_for_death_composer
			}
			
			kill_pop = yes
		}
		
		name = shroud_criticality.304.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		every_owned_pop = {
			limit = {
				has_pop_flag = marked_for_death_composer
			}
			
			kill_pop = yes
		}
		
		name = shroud_criticality.304.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		every_owned_pop = {
			limit = {
				has_pop_flag = marked_for_death_composer
			}
			
			kill_pop = yes
		}
		
		name = shroud_criticality.304.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		every_owned_pop = {
			limit = {
				has_pop_flag = marked_for_death_composer
			}
			
			kill_pop = yes
		}
		
		name = shroud_criticality.304.f
	}
}

# Issue special project - Curse of the Composer - Cure
country_event = {
	id = shroud_criticality.305
	title = shroud_criticality.305.name
	desc = shroud_criticality.305.desc
	picture = GFX_evt_genetic_modification
	show_sound = event_administrative_work
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.305.a
		
		save_event_target_as = curer_of_disease
		capital_scope = {
			enable_special_project = {
				name = "PLAGUE_OF_THE_SHROUD_CURE_PROJECT"
				location = this
				owner = root
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.305.b
		
		save_event_target_as = curer_of_disease
		capital_scope = {
			enable_special_project = {
				name = "PLAGUE_OF_THE_SHROUD_CURE_PROJECT"
				location = this
				owner = root
			}
		}
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.305.c
		
		save_event_target_as = curer_of_disease
		capital_scope = {
			enable_special_project = {
				name = "PLAGUE_OF_THE_SHROUD_CURE_PROJECT"
				location = this
				owner = root
			}
		}
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.305.d
		
		save_event_target_as = curer_of_disease
		capital_scope = {
			enable_special_project = {
				name = "PLAGUE_OF_THE_SHROUD_CURE_PROJECT"
				location = this
				owner = root
			}
		}
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.305.e
		
		save_event_target_as = curer_of_disease
		capital_scope = {
			enable_special_project = {
				name = "PLAGUE_OF_THE_SHROUD_CURE_PROJECT"
				location = this
				owner = root
			}
		}
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.305.f
		
		save_event_target_as = curer_of_disease
		capital_scope = {
			enable_special_project = {
				name = "PLAGUE_OF_THE_SHROUD_CURE_PROJECT"
				location = this
				owner = root
			}
		}
	}
}

# Composer of Strands - Cure Success - Warn country
country_event = {
	id = shroud_criticality.306
	title = shroud_criticality.306.name
	desc = shroud_criticality.306.desc
	picture = GFX_evt_genetic_modification
	show_sound = event_administrative_work
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_composer_lv1_cured
		observer_event = { id = shroud_criticality.5009 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.306.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.306.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.306.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.306.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.306.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.306.f
	}
}

# Whisperers of the Void
country_event = {
	id = shroud_criticality.400
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		Log = "Whisperers of the Void"
	
		every_country = {
			limit = {
				is_country_type = shroud
			}
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {
			if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_7
						has_country_flag = shroud_lvl_8
					}
				}
				
				country_event = { id = shroud_criticality.405 days = 180 random = 180 }
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_6
					}
				}
				
				country_event = { id = shroud_criticality.403 days = 180 random = 180 }
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_5
					}
				}
				
				country_event = { id = shroud_criticality.401 days = 180 random = 180 }
			}
			
			else = {}
		}
	}
}

# Whisperers of the Void - Level 1
country_event = {
	id = shroud_criticality.401
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				any_owned_pop = {
					OR = {
						has_trait = trait_latent_psionic
						has_trait = trait_psionic
					}
					is_being_purged = no
				}
			}
			
			every_owned_planet = {
				every_owned_pop = {
					limit = {
						OR = {
							has_trait = trait_mechanical
						}
						is_being_purged = no
						NOT = { has_modifier = pop_whisperer_robot }
					}
				
					add_modifier = { modifier = pop_whisperer_robot days = 720 }
				}
			}
			
			country_event = { id = shroud_criticality.402 }
		}
	}
}

# Whisperers of the Void - Level 1 - Warn country
country_event = {
	id = shroud_criticality.402
	title = shroud_criticality.402.name
	desc = shroud_criticality.402.desc
	picture = GFX_evt_synth_organic_relations
	show_sound = event_bad_omen
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_whisperer_lv1
		observer_event = { id = shroud_criticality.5010 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.402.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.402.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.402.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.402.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.402.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.402.f
	}
}

# Whisperers of the Void - Level 2
country_event = {
	id = shroud_criticality.403
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
						NOT = {
							any_owned_pop = {
								OR = {
									has_trait = trait_latent_psionic
									has_trait = trait_psionic
								}
							}
						}
					}
				}
				any_owned_leader = {
					species = {
						NOT = {
							OR = {
								has_trait = trait_machine_unit
								has_trait = trait_mechanical
								has_trait = trait_hive_mind
							}
						}
					}
					leader_class = scientist
				}
			}
			
			random_owned_leader = {
				limit = {
					species = {
						NOT = {
							OR = {
								has_trait = trait_machine_unit
								has_trait = trait_mechanical
								has_trait = trait_hive_mind
							}
						}
					}
					leader_class = scientist
				}
				
				save_event_target_as = chosen_leader
			}
			
			country_event = { id = shroud_criticality.404 }
		}
	}
}

# Whisperers of the Void - Level 2 - Warn country
country_event = {
	id = shroud_criticality.404
	title = shroud_criticality.404.name
	desc = shroud_criticality.404.desc
	picture = GFX_evt_zro_2
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_whisperer_lv2
		observer_event = { id = shroud_criticality.5011 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_leader = {
			add_trait = leader_trait_paranoid
			add_trait = leader_trait_substance_abuser
		}
		
		name = shroud_criticality.404.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_leader = {
			add_trait = leader_trait_paranoid
			add_trait = leader_trait_substance_abuser
		}
		
		name = shroud_criticality.404.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_leader = {
			add_trait = leader_trait_paranoid
			add_trait = leader_trait_substance_abuser
		}
		
		name = shroud_criticality.404.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		event_target:chosen_leader = {
			add_trait = leader_trait_paranoid
			add_trait = leader_trait_substance_abuser
		}
		
		name = shroud_criticality.404.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		event_target:chosen_leader = {
			add_trait = leader_trait_paranoid
			add_trait = leader_trait_substance_abuser
		}
		
		name = shroud_criticality.404.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		event_target:chosen_leader = {
			add_trait = leader_trait_paranoid
			add_trait = leader_trait_substance_abuser
		}
		
		name = shroud_criticality.404.f
	}
}

# Whisperers of the Void - Level Max
country_event = {
	id = shroud_criticality.405
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				any_owned_leader = {
					OR = {
						has_trait = "leader_trait_admiral_psionic"
						has_trait = "leader_trait_general_psionic"
						has_trait = "leader_trait_governor_psionic"
						has_trait = "leader_trait_scientist_psionic"
					}
				}
			}
			
			random_owned_leader = {
				limit = {
					OR = {
						has_trait = "leader_trait_admiral_psionic"
						has_trait = "leader_trait_general_psionic"
						has_trait = "leader_trait_governor_psionic"
						has_trait = "leader_trait_scientist_psionic"
					}
				}
				
				save_event_target_as = chosen_leader
			}
			
			country_event = { id = shroud_criticality.404 }
		}
	}
}

# Whisperers of the Void - Level Max - Warn country
country_event = {
	id = shroud_criticality.406
	title = shroud_criticality.406.name
	desc = shroud_criticality.406.desc
	picture = GFX_evt_zro_2
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_whisperer_lv3
		observer_event = { id = shroud_criticality.5012 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		
		name = shroud_criticality.406.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		
		name = shroud_criticality.406.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		
		name = shroud_criticality.406.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		
		name = shroud_criticality.406.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		
		name = shroud_criticality.406.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		
		name = shroud_criticality.406.f
	}
}

# Eater of Worlds
country_event = {
	id = shroud_criticality.500
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
	
		Log = "Eater of Worlds"
		
		every_country = {
			limit = {
				is_country_type = shroud
			}
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {
			if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_7
						has_country_flag = shroud_lvl_8
					}
				}
				log = "7 or 8"
				country_event = { id = shroud_criticality.510 }
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_6
					}
				}
				log = "6"
				country_event = { id = shroud_criticality.503 }
			}
			
			else_if = {
				limit = {
					OR = {
						has_country_flag = shroud_lvl_5
					}
				}
				log = "5"
				country_event = { id = shroud_criticality.501 }
			}
			
			else = {}
		}
	}
}

# Eater of Worlds - Level 1
country_event = {
	id = shroud_criticality.501
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				any_owned_pop = {
					OR = {
						has_trait = trait_latent_psionic
						has_trait = trait_psionic
					}
					is_being_purged = no
				}
			}
			
			random_owned_planet = {
				limit = {
					num_pops > 5
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
				}
				
				save_event_target_as = chosen_planet
			}
			
			country_event = { id = shroud_criticality.502 }
		}
	}
}

# Eater of Worlds - Level 1 - Warn country
country_event = {
	id = shroud_criticality.502
	title = shroud_criticality.502.name
	desc = shroud_criticality.502.desc
	picture = GFX_evt_zro_4
	show_sound = event_screams
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_eater_lv1
		observer_event = { id = shroud_criticality.5013 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			add_modifier = { modifier = planet_eater_ate_lv1 days = 720 }
			
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.502.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			add_modifier = { modifier = planet_eater_ate_lv1 days = 720 }
			
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.502.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			add_modifier = { modifier = planet_eater_ate_lv1 days = 720 }
			
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.502.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		event_target:chosen_planet = {
			add_modifier = { modifier = planet_eater_ate_lv1 days = 720 }
			
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.502.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		event_target:chosen_planet = {
			add_modifier = { modifier = planet_eater_ate_lv1 days = 720 }
			
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.502.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		event_target:chosen_planet = {
			add_modifier = { modifier = planet_eater_ate_lv1 days = 720 }
			
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.502.f
	}
}

# Eater of Worlds - Level 2
country_event = {
	id = shroud_criticality.503
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud_spirits
			}
			save_event_target_as = shroud_country
		}
		
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				any_owned_pop = {
					OR = {
						has_trait = trait_latent_psionic
						has_trait = trait_psionic
					}
					is_being_purged = no
				}
			}
			
			establish_communications_no_message = event_target:shroud_country
						
			random_owned_planet = {
				limit = {
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
					num_pops > 25
				}
				
				save_event_target_as = chosen_planet

				add_planet_devastation = 30
				
				while = {
					count = 9
					create_army = {
						name = "Destroyers of He who Eats the Worlds"
						owner = event_target:shroud_country
						type = "shroud_lesser_demons_army"
					}
				}
				
				create_army = {
					name = "Greater Demon of the Eater of Worlds"
					owner = event_target:shroud_country
					type = "shroud_demon_army"
				}
			}
			
			country_event = { id = shroud_criticality.504 }
		}
	}
}

# Eater of Worlds - Level 2 - Warn country
country_event = {
	id = shroud_criticality.504
	title = shroud_criticality.504.name
	desc = shroud_criticality.504.desc
	picture = GFX_evt_zro_3
	show_sound = event_red_alert
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_eater_lv2
		observer_event = { id = shroud_criticality.5014 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.c
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.f
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_pacifist
				has_ethic = ethic_fanatic_pacifist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.g
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.h
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_egalitarian
				has_ethic = ethic_fanatic_egalitarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.i
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.j
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		event_target:chosen_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
			
			random_owned_pop = {
				kill_pop = yes
			}
		}
		
		name = shroud_criticality.504.k
	}
}

# Eater of Worlds - Level 2 - planet invasion outcome - Defender looses
# This = country, planet owner
# From = country, attack leader
# FromFrom = planet
country_event = {
	id = shroud_criticality.505
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				From = { is_country_type = shroud_spirits }
			}
			
			From = { save_event_target_as = shroud_attacker }
			
			FromFrom = {
				save_event_target_as = chosen_planet
				
				add_modifier = { modifier = planet_eater_invaded_lv2 days = -1 }
			}
			
			This = { country_event = { id = shroud_criticality.507 } }
		}
		
		else_if = {
			limit = {
				FromFrom = { has_modifier = planet_eater_invaded_lv2 }
			}
			
			FromFrom = {
				save_event_target_as = chosen_planet
				remove_modifier = planet_eater_invaded_lv2
			}
			
			From = { country_event = { id = shroud_criticality.508 } }
		}
	}
}

# Eater of Worlds - Level 2 - planet invasion outcome - Shroud loose its attack
# This = country, planet owner
# From = country, attack leader
# FromFrom = planet
country_event = {
	id = shroud_criticality.506
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				From = { is_country_type = shroud_spirits }
			}
			
			From = { save_event_target_as = shroud_attacker }
			
			FromFrom = {
				save_event_target_as = chosen_planet
				remove_modifier = planet_eater_invaded_lv2
			}
			
			This = { country_event = { id = shroud_criticality.508 } }
		}
	}
}         

# Eater of Worlds - Level 2 - Defenders lose to Shroud
country_event = {
	id = shroud_criticality.507
	title = shroud_criticality.507.name
	desc = shroud_criticality.507.desc
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.c
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.507.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.507.f
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_pacifist
				has_ethic = ethic_fanatic_pacifist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.g
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.h
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_egalitarian
				has_ethic = ethic_fanatic_egalitarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.i
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.j
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.507.k
	}
}

# Eater of Worlds - Level 2 - Defenders win or Shroud invaders are defeated upon a country attack
country_event = {
	id = shroud_criticality.508
	title = shroud_criticality.508.name
	desc = shroud_criticality.508.desc
	picture = GFX_evt_victorious_army
	show_sound = event_ground_battle
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.c
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.508.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.508.f
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_pacifist
				has_ethic = ethic_fanatic_pacifist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.g
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.h
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_egalitarian
				has_ethic = ethic_fanatic_egalitarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.i
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.j
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.508.k
	}
}

# Eater of Worlds - Level 2 - Purge Pop
event = {
	id = shroud_criticality.509
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_planet = {
			limit = {
				has_modifier = planet_eater_invaded_lv2
			}
			
			if = {
				limit = {
					NOT = { controller = { is_country_type = shroud_spirits } }
				}
				
				remove_modifier = planet_eater_invaded_lv2
			}
			
			else = {
				if = {
					limit = {
						num_pops = 1
					}
					
					remove_modifier = planet_eater_invaded_lv2
				}
				
				random_pop = {
					kill_pop = yes
				}
			}
		}
	}
}

# Eater of Worlds - Level Max
country_event = {
	id = shroud_criticality.510
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud_spirits
			}
			save_event_target_as = shroud_country
		}
		
		log = "Eater Max"
		
		random_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				any_owned_planet = {
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
					is_capital = no
					num_pops > 25
				}
			}
			
			log = "Pays = [This.GetName]"
			
			random_owned_planet = {
				limit = {
					any_owned_pop = {
						OR = {
							has_trait = trait_latent_psionic
							has_trait = trait_psionic
						}
						is_being_purged = no
					}
					is_capital = no
					num_pops > 25
				}
				
				log = "Planete = [This.GetName]"
				
				save_event_target_as = chosen_planet
				
				every_owned_pop = {
					kill_pop = yes
				}
				
				destroy_colony = yes
				
				if = {
					limit = {
						OR = {
							is_planet_class = pc_arctic
							is_planet_class = pc_tundra
							is_planet_class = pc_alpine
							is_planet_class = pc_desert
							is_planet_class = pc_arid
							is_planet_class = pc_savannah
							is_planet_class = pc_continental
							is_planet_class = pc_ocean
							is_planet_class = pc_tropical
							is_planet_class = pc_relic
							is_planet_class = pc_city
							is_planet_class = pc_gaia
							is_planet_class = pc_machine
							is_planet_class = pc_hive
						}
					}
					
					change_pc = pc_shrouded
				}
				
				else_if = {
					limit = {
						is_planet_class = pc_ringworld_habitable
					}
					
					change_pc = pc_ringworld_habitable_damaged
				}
				
				else_if = {
					limit = {
						is_planet_class = pc_habitat
					}
					
					remove_planet = yes
				}
				
				clear_planet_modifiers = yes
				clear_deposits = yes
				
				add_zro = yes
				
				Prev = { country_event = { id = shroud_criticality.511 } }
			}
		}
	}
}

# Eater of Worlds - Level Max - Warn country
country_event = {
	id = shroud_criticality.511
	title = shroud_criticality.511.name
	desc = shroud_criticality.511.desc
	picture = GFX_evt_shrouded
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_whisperer_lv3
		observer_event = { id = shroud_criticality.5015 }
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.511.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.511.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.511.c
	}
	
	option = {
		trigger = {
			AND = {
				NOT = { has_ethic = ethic_materialist }
				NOT = { has_ethic = ethic_fanatic_materialist }
				NOT = { has_ethic = ethic_spiritualist }
				NOT = { has_ethic = ethic_fanatic_spiritualist }
				NOT = { has_ethic = ethic_authoritarian }
				NOT = { has_ethic = ethic_fanatic_authoritarian }
				NOT = { 
					OR = {
						leader = { has_trait = leader_trait_ruler_psionic }
						leader = { has_trait = leader_trait_ruler_chosen }
					}
				}
			}
		}
		
		name = shroud_criticality.511.d
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.511.e
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		name = shroud_criticality.511.f
	}
}

# End of the Cycle (Special)
country_event = {
	id = shroud_criticality.1000
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		Log = "End of the Cycle"
		random_country = {
			limit = {
				OR = {
					has_modifier = covenant_whisperers_in_the_void
					has_modifier = covenant_composer_of_strands
					has_modifier = covenant_eater_of_worlds
					has_modifier = covenant_instrument_of_desire
					has_modifier = covenant_end_of_the_cycle
				}
				AND = {
					NOT = { has_country_flag = dark_side }
					NOT = { has_country_flag = clear_side }
				}
			}
			
			country_event = { id = shroud_criticality.1001 }
		}
	}
}

# Proposition
country_event = {
	id = shroud_criticality.1001
	title = shroud_criticality.1001.name
	desc = shroud_criticality.1001.desc
	picture = GFX_evt_psionics
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = observer_country_end_pact
		observer_event = { id = shroud_criticality.5016 }
	}
	
	option = {	
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		set_country_flag = dark_side
		
		country_event = { id = shroud_criticality.1002 }
		
		save_event_target_as = observer_country_end_pact_accepted
		observer_event = { id = shroud_criticality.5017 }
		
		name = shroud_criticality.1001.a
	}
	
	option = {
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		save_event_target_as = observer_country_end_pact_refused
		observer_event = { id = shroud_criticality.5018 }
		
		set_country_flag = clear_side
	
		name = shroud_criticality.1001.b
	}
}

# You just became the End
country_event = {
	id = shroud_criticality.1002
	title = shroud_criticality.1002.name
	desc = shroud_criticality.1002.desc
	picture = GFX_evt_unspeakable_horror
	show_sound = event_screams
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = dark_sider
		
		leave_alliance = {
			override_requirements = yes
		}
	
		clear_ethos = yes
		
		shift_ethic = "ethic_authoritarian"
		shift_ethic = "ethic_spiritualist"
		shift_ethic = "ethic_militarist"
		
		remove_from_galactic_community = yes
		
		if = {
			limit = {
				NOT = { has_authority = auth_corporate }
			}
			
			change_government = {
				authority = auth_imperial
				civics = {
					civic = civic_cutthroat_politics
					civic = civic_warrior_culture
					civic = civic_distinguished_admiralty
				}
			}
		}
		
		else = {
			change_government = {
				civics = {
					civic = civic_criminal_heritage
					civic = civic_gospel_of_the_masses
					civic = civic_ruthless_competition
				}
			}
		}
		
		switch = {
			trigger = has_modifier
			covenant_whisperers_in_the_void = {
				random_list = {
					10 = { set_name = "Artisans of Change" }
					10 = { set_name = "Wanderers of Secrets" }
					10 = { set_name = "They who Hear" }
					10 = { set_name = "Seekers of Knowledge" }
					10 = { set_name = "Unravelers of Aether" }
					10 = { set_name = "Weavers of Fate" }
					10 = { set_name = "They who Learn" }
					10 = { set_name = "Architects of Fate" }
					10 = { set_name = "Changers of the Ways" }
					10 = { set_name = "Ploters of the Void" }
				}
			}
			covenant_composer_of_strands = {
				random_list = {
					10 = { set_name = "They who never Decay" }
					10 = { set_name = "The Ascended" }
					10 = { set_name = "They who Grow" }
					10 = { set_name = "Bringers of Rot" }
					10 = { set_name = "Lifebearers" }
					10 = { set_name = "The Genomancers" }
					10 = { set_name = "Sharers of Immunity" }
				}
			}
			covenant_eater_of_worlds = {
				random_list = {
					10 = { set_name = "Heralds of Carnage" }
					10 = { set_name = "Blood Reavers" }
					10 = { set_name = "Skull Collectors" }
					10 = { set_name = "Worlds Slayers" }
					10 = { set_name = "Void Widowmakers" }
					10 = { set_name = "Chaos Sweepers" }
					10 = { set_name = "Warbringers" }
					10 = { set_name = "They who fight" }
					10 = { set_name = "Apostles of Onslaught" }
					10 = { set_name = "Legions of Doom" }
				}
			}
			covenant_instrument_of_desire = {
				random_list = {
					10 = { set_name = "Courtiers of Lust" }
					10 = { set_name = "Languid Hedonists" }
					10 = { set_name = "They who Thrive" }
					10 = { set_name = "Scroungers of Opulence" }
					10 = { set_name = "Arrogant Cultists" }
					10 = { set_name = "Pleasure Slaves" }
					10 = { set_name = "They who Feast" }
					10 = { set_name = "Adepts of Pleasure" }
				}
			}
			covenant_end_of_the_cycle = {
				set_name = "The Embodiment of the End"
			}
		}
		
		every_owned_pop = {
			random_list = {
				33 = { pop_change_ethic = ethic_spiritualist }
				33 = { pop_change_ethic = ethic_militarist }
				33 = { pop_change_ethic = ethic_authoritarian }
			}
			
			force_faction_evaluation = yes
		}
		
		every_country = {
			limit = {
				NOT = { is_same_value = root }
			}
			
			country_event = { id = shroud_criticality.1003 }
		}
	}
	
	option = {
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.1002.a
	}
}

# Someone just became a D4rk B0Y !
country_event = {
	id = shroud_criticality.1003
	title = shroud_criticality.1003.name
	desc = shroud_criticality.1003.desc
	picture = GFX_evt_unspeakable_horror
	show_sound = event_screams
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			NOT = { 
				OR = {
					ruler = { has_trait = leader_trait_ruler_psionic }
					ruler = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		name = shroud_criticality.1003.a
	}
	
	option = {
		trigger = {
			OR = {
				ruler = { has_trait = leader_trait_ruler_psionic }
				ruler = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		name = shroud_criticality.1003.b
	}
}

# V) Bonuses

country_event = {
	id = shroud_criticality.1100
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		Log = "Boons"
		every_country = {
			limit = {
				is_country_type = shroud
			}
			save_event_target_as = shroud_country
		}
		
		every_country = {
			limit = {
				is_country_type = default
				NOT = { has_policy_flag = psykers_outlawed }
				NOT = { has_country_flag = dark_side }
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
				any_owned_pop = {
					OR = {
						has_trait = trait_latent_psionic
						has_trait = trait_psionic
					}
					is_being_purged = no
				}
				AND = {
					NOT = { has_modifier = boon_end }
				}
			}
			
			country_event = { id = shroud_criticality.1101 }
		}
	}
}

# Bonus Selector
country_event = {
	id = shroud_criticality.1101
	title = shroud_criticality.1101.name
	desc = shroud_criticality.1101.desc
	picture = GFX_evt_galactic_community
	show_sound = event_galactic_community
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
			AND = {
				NOT = { has_modifier = boon_instrument }
				NOT = { has_modifier = boon_instrument_spi }
			}
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_instrument_spi days = 180 }
		
		name = shroud_criticality.1101.a
	}
	
	option = {
		trigger = {
			NOT = { has_ethic = ethic_fanatic_spiritualist }
			NOT = { has_ethic = ethic_spiritualist }
			NOT = { has_modifier = boon_instrument }
			NOT = { has_modifier = boon_instrument_spi }
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_instrument days = 180 }
		
		name = shroud_criticality.1101.b
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
			AND = {
				NOT = { has_modifier = boon_composer }
				NOT = { has_modifier = boon_composer_spi }
			}
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_composer_spi days = 180 }
		
		name = shroud_criticality.1101.c
	}
	
	option = {
		trigger = {
			NOT = { has_ethic = ethic_fanatic_spiritualist }
			NOT = { has_ethic = ethic_spiritualist }
			NOT = { has_modifier = boon_composer }
			NOT = { has_modifier = boon_composer_spi }
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_composer days = 180 }
		
		name = shroud_criticality.1101.d
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
			AND = {
				NOT = { has_modifier = boon_whisperer }
				NOT = { has_modifier = boon_whisperer_spi }
			}
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_whisperer_spi days = 180 }
		
		name = shroud_criticality.1101.e
	}
	
	option = {
		trigger = {
			NOT = { has_ethic = ethic_fanatic_spiritualist }
			NOT = { has_ethic = ethic_spiritualist }
			NOT = { has_modifier = boon_whisperer }
			NOT = { has_modifier = boon_whisperer_spi }
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_whisperer days = 180 }
		
		name = shroud_criticality.1101.f
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
			AND = {
				NOT = { has_modifier = boon_eater }
				NOT = { has_modifier = boon_eater_spi }
			}
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_eater_spi days = 180 }
		
		name = shroud_criticality.1101.g
	}
	
	option = {
		trigger = {
			NOT = { has_ethic = ethic_fanatic_spiritualist }
			NOT = { has_ethic = ethic_spiritualist }
			NOT = { has_modifier = boon_eater }
			NOT = { has_modifier = boon_eater_spi }
			NOT = { has_country_flag = dark_side }
		}
		
		add_modifier = { modifier = boon_eater days = 180 }
		
		name = shroud_criticality.1101.h
	}
	
	option = {
		trigger = {
			OR = {
				has_country_flag = dark_side
				has_modifier = covenant_end_of_the_cycle
			}
		}
		
		add_modifier = { modifier = boon_end days = 180 }
		
		name = shroud_criticality.1101.darkside
	}
}

# VI) Miscellaneous

# Warn other countries about the Shroud criticality
event = {
	id = shroud_criticality.2000
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			save_event_target_as = shroud_country
		}
		
		if = {
			every_country = {
				limit = {
					any_owned_planet = {
						any_owned_pop = {
							OR = {
								has_trait = trait_latent_psionic
								has_trait = trait_psionic
							}
						}
					}
					NOT = { has_country_flag = was_warned_about_shroud }
					is_country_type = default
					NOT = {
						OR = {
							is_country_type = awakened_fallen_empire
							is_country_type = fallen_empire
						}
					}
				}
				
				set_country_flag = was_warned_about_shroud
				
				this = { country_event = { id = shroud_criticality.2001 days = 1800 random = 1800 } }
			}
		}
		
		else = {}
	}
}

# Special Project to lower the Shroud
country_event = {
	id = shroud_criticality.2001
	title = shroud_criticality.2001.name
	desc = shroud_criticality.2001.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		save_event_target_as = shroud_prober
		
		capital_scope = {
			enable_special_project = {
				name = "LOWER_SHROUD_PROJECT"
				location = this
				owner = root
			}
		}
		
		name = shroud_criticality.2001.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		save_event_target_as = shroud_prober
		
		capital_scope = {
			enable_special_project = {
				name = "LOWER_SHROUD_PROJECT"
				location = this
				owner = root
			}
		}
		
		name = shroud_criticality.2001.b
	}
	
	option = {
		trigger = {
			NAND = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		save_event_target_as = shroud_prober
		
		capital_scope = {
			enable_special_project = {
				name = "LOWER_SHROUD_PROJECT"
				location = this
				owner = root
			}
		}
		
		name = shroud_criticality.2001.c
	}
	
	option = {
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		save_event_target_as = shroud_prober
		
		capital_scope = {
			enable_special_project = {
				name = "LOWER_SHROUD_PROJECT"
				location = this
				owner = root
			}
		}
		
		name = shroud_criticality.2001.d
	}
	
		option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		save_event_target_as = shroud_prober
		
		capital_scope = {
			enable_special_project = {
				name = "LOWER_SHROUD_PROJECT"
				location = this
				owner = root
			}
		}
		
		name = shroud_criticality.2002.e
	}
}

# Special Project finished
country_event = {
	id = shroud_criticality.2002
	title = shroud_criticality.2002.name
	desc = shroud_criticality.2002.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		set_country_flag = can_lower_shroud
		add_research_option = tech_mine_zro
		
		name = shroud_criticality.2002.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		set_country_flag = can_lower_shroud
		add_research_option = tech_mine_zro
		
		name = shroud_criticality.2002.b
	}
	
	option = {
		trigger = {
			NAND = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
		}
		
		set_country_flag = can_lower_shroud
		add_research_option = tech_mine_zro
		
		name = shroud_criticality.2002.c
	}
	
	option = {
		trigger = {
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
		}
		
		set_country_flag = can_lower_shroud
		add_research_option = tech_mine_zro
		
		name = shroud_criticality.2002.d
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
		}
		
		set_country_flag = can_lower_shroud
		add_research_option = tech_mine_zro
		
		name = shroud_criticality.2002.e
	}
}

# Someone lowered the Shroud
country_event = {
	id = shroud_criticality.3000
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		save_event_target_as = lowering_country
		
		every_country = {
			limit = {
				is_country_type = shroud
			}
			
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = { country_event = { id = shroud_criticality.2 } }
		
		every_country = {
			limit = {
				has_country_flag = can_lower_shroud
				is_country_type = default
				NOT = {
					OR = {
						is_country_type = awakened_fallen_empire
						is_country_type = fallen_empire
					}
				}
			}
			
			country_event = { id = shroud_criticality.3001 }
		}
	}
}

# Someone lowered the Shroud - Warn
country_event = {
	id = shroud_criticality.3001
	title = shroud_criticality.3001.name
	
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	desc = {
		text = shroud_criticality.3001.desc
		trigger = {
			NOT = { is_same_value = root }
		}
	}
	
	desc = {
		text = shroud_criticality.3001.desc.own
		trigger = {
			is_same_value = root
		}
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
			NOT = { has_country_flag = dark_side }
			NOT = { is_same_value = root }
		}
		
		name = shroud_criticality.3001.a
	}
	
	option = {
		trigger = {
			OR = {
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
			NOT = { has_country_flag = dark_side }
			NOT = { is_same_value = root }
		}
		
		name = shroud_criticality.3001.b
	}
	
	option = {
		trigger = {
			NAND = {
				has_ethic = ethic_fanatic_spiritualist
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_materialist
				has_ethic = ethic_materialist
			}
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
			NOT = { has_country_flag = dark_side }
			NOT = { is_same_value = root }
		}
		
		name = shroud_criticality.3001.c
	}
	
	option = {
		trigger = {
			NOT = { 
				OR = {
					leader = { has_trait = leader_trait_ruler_psionic }
					leader = { has_trait = leader_trait_ruler_chosen }
				}
			}
			NOT = { has_country_flag = dark_side }
			NOT = { is_same_value = root }
		}
		
		name = shroud_criticality.3001.d
	}
	
	option = {	
		trigger = {
			has_authority = "auth_machine_intelligence"
			NOT = { is_same_value = root }
		}
		
		name = shroud_criticality.3001.e
	}
	
	option = {	
		trigger = {
			has_country_flag = dark_side
			OR = {
				leader = { has_trait = leader_trait_ruler_psionic }
				leader = { has_trait = leader_trait_ruler_chosen }
			}
			NOT = { is_same_value = root }
		}
		
		name = shroud_criticality.3001.f
	}
	
	option = {	
		trigger = {
			is_same_value = root
		}
		
		name = shroud_criticality.3001.g
	}
}

# Observers events

# Avatar
observer_event = {
	id = shroud_criticality.5000
	title = shroud_criticality.5000.name
	desc = shroud_criticality.5000.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:shroud_spawn_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# FTL Problems
observer_event = {
	id = shroud_criticality.5001
	title = shroud_criticality.5001.name
	desc = shroud_criticality.5001.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Psykers detected
observer_event = {
	id = shroud_criticality.5002
	title = shroud_criticality.5002.name
	desc = shroud_criticality.5002.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Horrors of the Warp
observer_event = {
	id = shroud_criticality.5003
	title = shroud_criticality.5003.name
	desc = shroud_criticality.5003.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Instrument lv 1
observer_event = {
	id = shroud_criticality.5004
	title = shroud_criticality.5004.name
	desc = shroud_criticality.5004.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Instrument lv 2
observer_event = {
	id = shroud_criticality.5005
	title = shroud_criticality.5005.name
	desc = shroud_criticality.5005.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Instrument lv Max
observer_event = {
	id = shroud_criticality.5006
	title = shroud_criticality.5006.name
	desc = shroud_criticality.5006.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Composer : Init
observer_event = {
	id = shroud_criticality.5007
	title = shroud_criticality.5007.name
	desc = shroud_criticality.5007.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Composer : Spreading
observer_event = {
	id = shroud_criticality.5008
	title = shroud_criticality.5008.name
	desc = shroud_criticality.5008.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Composer : Cure
observer_event = {
	id = shroud_criticality.5009
	title = shroud_criticality.5009.name
	desc = shroud_criticality.5009.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Whisperers lv 1
observer_event = {
	id = shroud_criticality.5010
	title = shroud_criticality.5010.name
	desc = shroud_criticality.5010.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Whisperers lv 2
observer_event = {
	id = shroud_criticality.5011
	title = shroud_criticality.5011.name
	desc = shroud_criticality.5011.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Whisperers lv Max
observer_event = {
	id = shroud_criticality.5012
	title = shroud_criticality.5012.name
	desc = shroud_criticality.5012.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Eater lv 1
observer_event = {
	id = shroud_criticality.5013
	title = shroud_criticality.5013.name
	desc = shroud_criticality.5013.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Eater lv 2
observer_event = {
	id = shroud_criticality.5014
	title = shroud_criticality.5014.name
	desc = shroud_criticality.5014.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# Eater lv Max
observer_event = {
	id = shroud_criticality.5015
	title = shroud_criticality.5015.name
	desc = shroud_criticality.5015.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# End of the Cycle - Pact
observer_event = {
	id = shroud_criticality.5016
	title = shroud_criticality.5016.name
	desc = shroud_criticality.5016.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# End of the Cycle - Pact Accepted
observer_event = {
	id = shroud_criticality.5017
	title = shroud_criticality.5017.name
	desc = shroud_criticality.5017.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

# End of the Cycle - Pussy
observer_event = {
	id = shroud_criticality.5018
	title = shroud_criticality.5018.name
	desc = shroud_criticality.5018.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	location = event_target:chosen_planet
	
	is_triggered_only = yes
	
	option = {
		name = OK
	}
}

#####

# Test only

country_event = {
	id = shroud_criticality.9999
	title = shroud_criticality.9999.name
	desc = shroud_criticality.9999.desc
	picture = GFX_evt_my_shroud
	show_sound = event_mystic_reveal
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				is_country_type = shroud
			}
			save_event_target_as = shroud_country
		}
		
		event_target:shroud_country = {
			if = {
				limit = {
					NOT = { has_country_flag = shroud_lvl_8 }
				}
				
				if = {
					limit = {
						NOT = { has_country_flag = shroud_lvl_7 }
					}
					
					if = {
						limit = {
							NOT = { has_country_flag = shroud_lvl_6 }
						}
						
						if = {
							limit = {
								NOT = { has_country_flag = shroud_lvl_5 }
							}
							
							if = {
								limit = {
									NOT = { has_country_flag = shroud_lvl_4 }
								}
								
								if = {
									limit = {
										NOT = { has_country_flag = shroud_lvl_3 }
									}
									
									if = {
										limit = {
											NOT = { has_country_flag = shroud_lvl_2 }
										}
										
										log = "1"
									}
									
									else = {
										log = "2"
									}
								}
								
								else = {
									log = "3"
								}
							}
							
							else = {
								log = "4"
							}
						}
						
						else = {
							log = "5"
						}
					}
					
					else = {
						log = "6"
					}
				}
				
				else = {
					log = "7"
				}
			}
			
			else = {
				log = "8"
			}
		}
	}
}