namespace = ti_nefishh

country_event = {
	id = ti_nefishh.1  #  enable further Nefishh events
	title = ti_nefishh.1.name
	desc = ti_nefishh.1.desc
	picture = GFX_evt_clocks
	is_triggered_only = yes
	
	trigger = {
		has_ascension_perk = ap_mind_over_matter
		owner_species = { has_trait = trait_natural_telepaths }
		Not = { has_country_flag = nefishh_created }
		}

	immediate = {
		set_country_flag = nefishh_created
	}
	
	option = {
		name = ti_nefishh.1.a
		custom_tooltip = ti_nefishh.1.a.tooltip
		hidden_effect = {
			set_country_flag = nefishh_firsttime
			country_event = { id = ti_nefishh.2 days = 360 }
		}
	}
}

country_event = {
	id = ti_nefishh.2  #  choose how to use the Nefishh
	title = ti_nefishh.2.name
	desc = {
		text = ti_nefishh.2.desca
		trigger = { has_country_flag = nefishh_firsttime }

	}
	desc = {
		text = ti_nefishh.2.descb
		trigger = { Not = { has_country_flag = nefishh_firsttime } }

	}
	picture = GFX_evt_clocks
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = nefishh_created
		owner_species = { has_trait = trait_natural_telepaths }
		}
		
	immediate = {
		remove_country_flag = nefishh_sway_envoys
	}

	option = {
		name = ti_nefishh.2.a
		custom_tooltip = ti_nefishh.2.a.tooltip
		ai_chance = {
			factor = 10
		}
		add_modifier = { modifier = nefishh_strengthen_collective days = 1800 }
		hidden_effect = {
			country_event = { id = ti_nefishh.2 days = 1800 }
		}
	}
	
	option = {
		name = ti_nefishh.2.b
		custom_tooltip = ti_nefishh.2.b.tooltip
		ai_chance = {
			factor = 10
		}
		add_modifier = { modifier = nefishh_focus_minds days = 1800 }
		hidden_effect = {
			country_event = { id = ti_nefishh.2 days = 1800 }
		}
	}
	
	option = {
		name = ti_nefishh.2.c
		custom_tooltip = ti_nefishh.2.c.tooltip
		ai_chance = {
			factor = 10
		}
		add_modifier = { modifier = nefishh_sensors days = 720 }
		hidden_effect = {
			country_event = { id = ti_nefishh.2 days = 720 }
		}
	}
	
	option = {
		name = ti_nefishh.2.d
		custom_tooltip = ti_nefishh.2.d.tooltip
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				OR = { has_ethic = ethic_fanatic_pacifist
						has_ethic = ethic_pacifist }
			}
		}
		set_country_flag = nefishh_sway_envoys
		hidden_effect = {
			country_event = { id = ti_nefishh.2 days = 720 }
		}
	}
	
	option = {
		name = ti_nefishh.2.e
		custom_tooltip = ti_nefishh.2.e.tooltip
		ai_chance = {
			factor = 10
		}
		allow = {
			custom_tooltip = {
				fail_text = ti_nefishh.2.e.fail
				count_neighbor_country = {
						limit = {
							is_country_type = default
							has_communications = root
							Not = { is_in_federation_with = root }
							Not = { has_non_aggression_pact = root }
							NOT = { has_ethic = ethic_gestalt_consciousness }
						}
						count > 1
				}
				
			}
		}
		hidden_effect = {
			random_neighbor_country = {
				limit = {
					is_country_type = default
					has_communications = root
					Not = { is_in_federation_with = root }
					Not = { has_non_aggression_pact = root }
					NOT = { has_ethic = ethic_gestalt_consciousness }
				}
				save_event_target_as = nefishh_sow_distrust_1
				set_country_flag = sow_distrust_1
			}
			random_neighbor_country = {
				limit = {
					is_country_type = default
					has_communications = root
					Not = { is_in_federation_with = root }
					Not = { has_non_aggression_pact = root }
					NOT = { has_ethic = ethic_gestalt_consciousness }
					Not = { has_country_flag = sow_distrust_1 }
				}
				save_event_target_as = nefishh_sow_distrust_2
			}
			event_target:nefishh_sow_distrust_1 = {
				remove_country_flag = sow_distrust_1
				add_opinion_modifier = { modifier = opinion_nefishh_sow_distrust who = event_target:nefishh_sow_distrust_2}
			}
			event_target:nefishh_sow_distrust_2 = {
				add_opinion_modifier = { modifier = opinion_nefishh_sow_distrust who = event_target:nefishh_sow_distrust_1}
			}
			country_event = { id = ti_nefishh.2 days = 720 }
			country_event = { id = ti_nefishh.3 }
		}
	}
	
	option = {
		name = ti_nefishh.2.f
		custom_tooltip = ti_nefishh.2.f.tooltip
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				is_at_war = yes
			}
		}
		trigger = { has_ascension_perk = ap_transcendence }
		allow = { has_ascension_perk = ap_transcendence }
		add_modifier = { modifier = nefishh_predict_future days = 720 }
		hidden_effect = {
			country_event = { id = ti_nefishh.2 days = 720 }
		}
	}
	
#	option = {
#		name = ti_nefishh.2.g
#		custom_tooltip = ti_nefishh.2.g.tooltip
#		trigger = { has_ascension_perk = ap_transcendence }
#		allow = {
#			has_ascension_perk = ap_transcendence
#			any_playable_country = {
#				has_authority = auth_hive_mind
#				has_communications = root
#			}
#		}
#		random_playable_country = {
#			limit = {
#				has_authority = auth_hive_mind
#				has_communications = root
#			}
#			random_list = {
#				
#			}
#		}
#	}
	after = {
		hidden_effect = {
			remove_country_flag = nefishh_firsttime
		}
	}	
}

country_event = {
	id = ti_nefishh.3  #  Sow distrust result
	title = ti_nefishh.3.name
	desc = ti_nefishh.3.desc
	picture = GFX_evt_clocks
	is_triggered_only = yes
	
	option = {
		name = ti_nefishh.3.a
	}
}
