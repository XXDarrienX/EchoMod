############################
#
# Expanded Colony Events
#
############################

namespace = colonyexpanded

##################################
# Subterranean Civilization Events
# Reserved 1 - 49
##################################

### Co-existance Events ###

# Hostile Subterranean Creatures
# Reserved 1 - 9
planet_event = {
	id = colonyexpanded.1
	title = "colonyexpanded.1.name"
	desc = "colonyexpanded.1.desc"
	picture = GFX_evt_alien_cavemen
	show_sound = event_primitive_civilization
	location = ROOT
	
	trigger = {
		has_planet_flag = seismic_disturbance_friendly
		NOT = { has_planet_flag = seismic_disturbance_creature }
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		has_ground_combat = no
		num_pops > 0
		check_variable = { 
			which = "angry_subterraneans" 
			value < 2
		}
	}
	
	mean_time_to_happen = {
		months = 720
	}
	
	immediate = {
		set_timed_planet_flag = {
			flag = seismic_disturbance_creature
			days = 27000
		}
	}
	
	option = {
		name = colony.69.a
		enable_special_project = {
			name = "SUBTERRANEAN_CREATURES_PROJECT"
			location = this
			owner = root.owner
		}
		hidden_effect = {
			change_variable = { 
				which = "angry_subterraneans" 
				value = -1 
			}
		}
		custom_tooltip = subterraneans_pleased
	}
	option = {
		name = colonyexpanded.1.b
		hidden_effect = {
			change_variable = { 
				which = "angry_subterraneans" 
				value = 1 
			}
			random_list = {
				50 = {
					# nothing happens
				}
				50 = {
					planet_event = { id = colonyexpanded.3 days = 360 random = 360 } # hostile creatures come to the surface, creates tile blocker
				}
			}
		}
		custom_tooltip = subterraneans_displeased
	}
}
ship_event = {
	id = colonyexpanded.2
	title = "PROJECT_COMPLETE"
	desc = "colonyexpanded.2.desc"
	picture = GFX_evt_alien_nature
	show_sound = event_primitive_civilization
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = colonyexpanded.2.a
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			add_monthly_resource_mult = {
				resource = influence
				value = @tier2influencereward
				min = @tier2influencemin
				max = @tier2influencemax
			}
		}
	}
}
planet_event = {
	id = colonyexpanded.3
	title = "colonyexpanded.1.name"
	desc = "colonyexpanded.3.desc"
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = TERRIBLE
		add_deposit = d_dangerous_wildlife_blocker
		every_owned_pop = {
			add_modifier = {
				modifier = "pop_angry_subterranean"
				days = 3600
			}
		}
	}
}
country_event = {
	id = colonyexpanded.4
	title = "colonyexpanded.1.name"
	desc = "colonyexpanded.3.desc"
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = TERRIBLE
		random_owned_planet  = {
			limit = { has_planet_flag = seismic_disturbance_creature }
			add_deposit = d_dangerous_wildlife_blocker
			hidden_effect = {
				change_variable = { 
					which = "angry_subterraneans" 
					value = 1 
				}
			}
			custom_tooltip = subterraneans_displeased
			every_owned_pop = {
				add_modifier = {
					modifier = "pop_angry_subterranean"
					days = 3600
				}
			}
		}
	}
}

# Request for Robots
planet_event = {
	id = colonyexpanded.10
	title = "colonyexpanded.10.name"
	desc = "colonyexpanded.10.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_primitive_civilization
	location = ROOT
	
	trigger = {
		has_planet_flag = seismic_disturbance_friendly
		NOT = { has_planet_flag = seismic_disturbance_robots }
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		has_ground_combat = no
		num_pops > 0
		any_pop = { is_robot_pop = yes }
	}
	
	mean_time_to_happen = {
		months = 600
	}
	
	immediate = {
		set_planet_flag = seismic_disturbance_robots
	}
	
	option = {
		name = colonyexpanded.10.a
		hidden_effect = {
			change_variable = {
				which = "angry_subterraneans" 
				value = 1
			}
		}
		custom_tooltip = subterraneans_displeased
	}
	option = {
		name = colonyexpanded.10.b
		trigger = {
			owner = { NOT = { has_technology = tech_synthetic_workers } }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier2materialreward
				min = @tier2materialmin
				max = @tier2materialmax
			}
		}
		hidden_effect = {
			random_pop = {
				limit = { is_robot_pop = yes }
				kill_pop = yes
			}
		}
		custom_tooltip = subterraneans_get_robot_pop
		hidden_effect = {
			change_variable = { 
				which = "angry_subterraneans" 
				value = -1
			}
			random_country = {
				limit = {
					is_country_type = adversary
					has_country_flag = subterranean_nation
				}
				set_country_flag = robot_request_approved
			}
		}
		custom_tooltip = subterraneans_pleased
	}
	option = {
		name = colonyexpanded.10.c
		trigger = {
			owner = { has_technology = tech_synthetic_workers }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier2materialreward
				min = @tier2materialmin
				max = @tier2materialmax
			}
		}
		hidden_effect = {
			owner = {
				add_resource = { minerals = -50 }
			}
		}
		custom_tooltip = subterraneans_must_build_droids
		hidden_effect = {
			change_variable = { 
				which = "angry_subterraneans" 
				value = -1
			}
			random_country = {
				limit = {
					is_country_type = adversary
					has_country_flag = subterranean_nation
				}
				set_country_flag = robot_request_approved
			}
		}
		custom_tooltip = subterraneans_pleased
	}
}

# Subterranean Engineers
planet_event = {
	id = colonyexpanded.11
	title = "colonyexpanded.11.name"
	desc = "colonyexpanded.11.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_primitive_civilization
	location = ROOT
	
	trigger = {
		has_planet_flag = seismic_disturbance_friendly
		NOT = { has_planet_flag = seismic_disturbance_engineers }
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		has_ground_combat = no
		num_pops > 0
	}
	
	mean_time_to_happen = {
		months = 600
	}
	
	immediate = {
		set_planet_flag = seismic_disturbance_engineers
	}
	
	option = {
		name = colonyexpanded.11.a
		hidden_effect = {
			change_variable = {
				which = "angry_subterraneans" 
				value = 1
			}
		}
		custom_tooltip = subterraneans_displeased
	}
	option = {
		name = colonyexpanded.11.b
		add_modifier = {
			modifier = "subterranean_engineers"
			days = 180
		}
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier1researchreward
				min = @tier1researchmin
				max = @tier1researchmax
			}
		}
		hidden_effect = {
			change_variable = {
				which = "angry_subterraneans" 
				value = -1
			}
			random_country = {
				limit = {
					is_country_type = adversary
					has_country_flag = subterranean_nation
				}
				set_country_flag = engineering_study_request_approved
			}
		}
		custom_tooltip = subterraneans_pleased
	}
}

# Engineering Project
# Reserved 12 - 20
planet_event = {
	id = colonyexpanded.12
	title = "colonyexpanded.12.name"
	desc = "colonyexpanded.12.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_primitive_civilization
	location = ROOT
	
	trigger = {
		has_planet_flag = seismic_disturbance_friendly
		NOT = { has_planet_flag = seismic_disturbance_engineering_project }
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		has_ground_combat = no
		num_pops > 0
		check_variable = { 
			which = "angry_subterraneans" 
			value < 2
		}
	}
	
	mean_time_to_happen = {
		months = 720
	}
	
	immediate = {
		set_timed_planet_flag = {
			flag = seismic_disturbance_engineering_project
			days = 18000
		}
	}
	
	option = {
		name = colonyexpanded.12.a
		enable_special_project = {
			name = "SUBTERRANEAN_EXVACATION_PROJECT"
			location = this
			owner = root.owner
		}
		hidden_effect = {
			change_variable = { 
				which = "angry_subterraneans" 
				value = -1 
			}
		}
		custom_tooltip = subterraneans_pleased
	}
	option = {
		name = colonyexpanded.12.b
		hidden_effect = {
			change_variable = {
				which = "angry_subterraneans" 
				value = 1 
			}
			random_list = {
				75 = {
					# nothing happens
				}
				25 = {
					planet_event = { id = colonyexpanded.13 days = 180 random = 180 } # project continues, causes earthquakes
				}
			}
		}
		custom_tooltip = subterraneans_displeased
	}
}

planet_event = {
	id = colonyexpanded.13
	title = colony.68.name
	desc = "colonyexpanded.13.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = TERRIBLE
		add_deposit = d_sinkhole_subterraneans
		every_owned_pop = {
			add_modifier = {
				modifier = "pop_angry_subterranean"
				days = 3600
			}
		}
	}
}

# Special Project Outcomes
planet_event = {
	id = colonyexpanded.14
	title = "PROJECT_COMPLETE"
	desc = "colonyexpanded.14.desc"
	picture = GFX_evt_archaeological_dig
	show_sound = event_primitive_civilization
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		owner = {
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
		}
	}
}
planet_event = {
	id = colonyexpanded.15
	title = "PROJECT_COMPLETE"
	desc = "colonyexpanded.15.desc"
	picture = GFX_evt_archaeological_dig
	show_sound = event_primitive_civilization
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
		}
	}
}
planet_event = {
	id = colonyexpanded.16
	title = "PROJECT_COMPLETE"
	desc = "colonyexpanded.16.desc"
	picture = GFX_evt_archaeological_dig
	show_sound = event_primitive_civilization
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		owner = {
			add_resource = {
				energy = 500
			}
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
		}
	}
}
planet_event = {
	id = colonyexpanded.17
	title = "PROJECT_COMPLETE"
	desc = "colonyexpanded.17.desc"
	picture = GFX_evt_alien_nature
	show_sound = event_primitive_civilization
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = colonyexpanded.17.a
		enable_special_project = {
			name = "SUBTERRANEAN_CREATURES_PROJECT"
			location = this
			owner = root.owner
		}
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
		}
	}
}
planet_event = {
	id = colonyexpanded.18
	title = "colonyexpanded.18.name"
	desc = "colonyexpanded.18.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = TERRIBLE
		add_deposit = d_sinkhole_subterraneans
		every_owned_pop = {
			add_modifier = {
				modifier = "pop_angry_subterranean"
				days = 3600
			}
		}
	}
}

# Study Subterranean Engineering
planet_event = {
	id = colonyexpanded.21
	title = "colonyexpanded.21.name"
	desc = "colonyexpanded.21.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_primitive_civilization
	location = ROOT
	
	trigger = {
		has_planet_flag = seismic_disturbance_friendly
		NOT = { has_planet_flag = seismic_disturbance_engineering }
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		has_ground_combat = no
		num_pops > 0
		check_variable = {
			which = "angry_subterraneans"
			value < 1
		}
	}
	
	mean_time_to_happen = {
		months = 720
	}
	
	immediate = {
		set_planet_flag = seismic_disturbance_engineering
	}
	
	option = {
		name = EXCELLENT
		owner = {
			if = {
				limit = {
					has_technology = tech_mining_2
					has_technology = tech_mineral_purification_1
				}
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier5researchreward
					min = @tier5researchmin
					max = @tier5researchmax
				}
			}
			if = {
				limit = {
					has_technology = tech_mining_2
					NOT = { has_technology = tech_mineral_purification_1 }
				}
				give_technology = { tech = tech_mineral_purification_1 }
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
			}
			if = {
				limit = { NOT = { has_technology = tech_mining_2 } }
				give_technology = { tech = tech_mining_2 }
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
			}
		}
	}
}

# Study Subterranean Engineering - Sinkhole Removal
planet_event = {
	id = colonyexpanded.22
	title = "colonyexpanded.22.name"
	desc = "colonyexpanded.22.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_primitive_civilization
	location = ROOT
	
	trigger = {
		has_planet_flag = seismic_disturbance_friendly
		NOT = { has_planet_flag = seismic_disturbance_sinkhole_tb }
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		has_ground_combat = no
		num_pops > 0
		check_variable = {
			which = "angry_subterraneans"
			value < 1
		}
		owner = {
			NOT = { has_technology = tech_deep_sinkhole }
		}
	}
	
	mean_time_to_happen = {
		months = 720
	}
	
	immediate = {
		set_planet_flag = seismic_disturbance_sinkhole_tb
	}
	
	option = {
		name = EXCELLENT
		owner = {
			give_technology = { tech = tech_deep_sinkhole }
		}
	}
}

# Subterranean Merchants
planet_event = {
	id = colonyexpanded.23
	title = "colonyexpanded.23.name"
	desc = "colonyexpanded.23.desc"
	picture = GFX_evt_underground_civilization
	show_sound = event_primitive_civilization
	location = ROOT
	
	trigger = {
		has_planet_flag = seismic_disturbance_friendly
		NOT = { has_planet_flag = seismic_disturbance_merchant_timer }
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		has_ground_combat = no
		num_pops > 0
		owner = { resource_stockpile_compare = { resource = energy value >= 500 } }
		check_variable = {
			which = "angry_subterraneans"
			value < 2
		}
	}
	
	mean_time_to_happen = {
		months = 360
	}
	
	immediate = {
		set_timed_planet_flag = {
			flag = seismic_disturbance_merchant_timer
			days = 1080
		}
	}
	
	option = {
		name = colonyexpanded.23.a
		trigger = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
		}
		owner = {
			add_resource = { energy = -1000 minerals = 800 alloys = 100 }
		}
	}
	
	option = {
		name = colonyexpanded.23.b
		owner = {
			add_resource = { energy = -500 minerals = 400 alloys = 50 }
		}
	}
	option = {
		name = colonyexpanded.23.c
	}
}

##################################
# Tomb World Events
# Reserved 50 - 99
##################################

# Tomb World Surveyed (sets flag so can still get some events if terraformed)
ship_event = {
	id = colonyexpanded.50
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { is_planet_class = pc_nuked }
	}

	immediate = {
		FROM = { set_planet_flag = colonized_tomb_world }
	}
}

# angry mutant creatures disturbed
# This = Planet
planet_event = {
	id = colonyexpanded.51
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_planet_flag = tomb_world_angry_mutant_animals }
		OR = {
			is_planet_class = pc_nuked
			has_planet_flag = colonized_tomb_world
			has_modifier = recovered_tomb_world
		}
	}
	
	immediate = {
		random_list = {
			199 = {
				# nothing happens
			}
			1 = {
				set_planet_flag = tomb_world_angry_mutant_animals
				planet_event = { id = colonyexpanded.52 }
			}
		}
	}
}
planet_event = {
	id = colonyexpanded.52
	title = "colonyexpanded.52.name"
	desc = "colonyexpanded.52.desc"
	picture = GFX_evt_ground_combat
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = TERRIBLE
		add_deposit = d_dangerous_wildlife_blocker
		if = {
			limit = { num_pops > 3 }
			random_pop = {
				kill_pop = yes
			}
		}
	}
}

##################################
# Special System Events
# Reserved 100 - 198
##################################

### Citadel ###
# Discover the Citadel
ship_event = {
	id = colonyexpanded.100
	title = "colonyexpanded.100.name"
	desc = "colonyexpanded.100.desc"
	picture = GFX_evt_satellite_in_orbit
	show_sound = event_radio_chatter
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
		owner = {
			NOT = { has_country_flag = encountered_citadel }
		}
		FROM = {
			has_star_flag = mass_effect_citadel_system
			any_system_planet = {
				has_planet_flag = mass_effect_citadel
			}
		}
	}
	
	immediate = {
		FROM = { save_event_target_as = citadel_system }
		owner = { set_country_flag = encountered_citadel }
	}
	
	option = {
		name = FASCINATING
	}
}

# Discover the Keepers
ship_event = {
	id = colonyexpanded.101
	title = "colonyexpanded.101.name"
	desc = "colonyexpanded.101.desc"
	picture = GFX_evt_satellite_in_orbit
	show_sound = event_radio_chatter
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
		FROM = {
			has_planet_flag = mass_effect_citadel
		}
	}
	
	immediate = {
		FROM = {
			solar_system =  { save_event_target_as = citadel_system }
		}
	}
	
	option = {
		name = FASCINATING
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier1researchreward
				min = @tier1researchmin
				max = @tier1researchmax
			}
		}
	}
}

# Keeper mush is pops!
event = {
	id = colonyexpanded.102
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		any_country = {
			NOT = { has_authority = auth_machine_intelligence }
			any_owned_planet = {
				has_planet_flag = mass_effect_citadel
				is_colony = yes
				is_under_colonization = no
				any_pop = {
					is_organic_species = yes
					has_job = unemployed
				}
			}
		}
	}
	
	immediate = {
		random_country = {
			limit = {
				NOT = { has_authority = auth_machine_intelligence }
				any_owned_planet = {
					has_planet_flag = mass_effect_citadel
					any_pop = {
						is_organic_species = yes
						has_job = unemployed
					}
				}
			}
			random_list = {
				1 = { }
				1 = {
					add_resource = { food = 500 }
					random_owned_planet = {
						limit = { has_planet_flag = mass_effect_citadel }
						random_pop = {
							limit = {
								is_organic_species = yes
								is_unemployed = yes
							}
							kill_pop = yes
						}
					}
				}
			}
		}
	}
}

### Dune ###
# Discover Arrakis
ship_event = {
	id = colonyexpanded.120
	title = "anomalymod.11.name"
	desc = "colonyexpanded.120.desc"
	picture = GFX_evt_arid
	show_sound = event_alien_nature
	location = FROM
	
	is_triggered_only = yes
	
	trigger = {
		FROM = {
			has_planet_flag = arrakis_planet
		}
	}
	
	option = {
		name = FASCINATING
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier1researchreward
				min = @tier1researchmin
				max = @tier1researchmax
			}
		}
	}
}

##################################
# Deposit and Blocker Events
# Reserved 199 - 298
##################################

# Deposit Tabola, five year intervals
event = {
	id = colonyexpanded.199
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_planet = {
			limit = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				is_capital = no
				exists = owner
				owner = { is_country_type = default }
			}
			planet_event = { id = colonyexpanded.200 days = 60 random = 1620 }
		}
	}
}
planet_event = {
	id = colonyexpanded.200
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		is_colony = yes
		is_under_colonization = no
		is_homeworld = no
		is_capital = no
		exists = owner
		owner = { is_country_type = default }
	}
	
	immediate = {
		random_list = {
			334 = { }
			# Curious Wildlife (dangerous wildlife)
			17 = { planet_event = { id = colonyexpanded.201 } }
			# volcanic earthquake reveals minerals (volcano)
			13 = { planet_event = { id = colonyexpanded.202 } }
			# Volcanic Eruption (volcano)
			16 = { planet_event = { id = colonyexpanded.203 } }
			# Hungry Wildlife (dangerous wildlife)
			14 = { planet_event = { id = colonyexpanded.204 } }
			# Sinkhole Deposit (sinkhole)
			17 = { planet_event = { id = colonyexpanded.205 } }
			# Sinkhole Collapses (sinkhole)
			16 = { planet_event = { id = colonyexpanded.206 } }
			# Biological Research (various)
			20 = { planet_event = { id = colonyexpanded.207 } }
			# Fertile Volcanic Lands (volcano)
			20 = { planet_event = { id = colonyexpanded.208 } }
			# Mineral Rich Mountain (mountain)
			16 = { planet_event = { id = colonyexpanded.209 } }
			# Exotic Gas Swamp (swamp)
			5 = { planet_event = { id = colonyexpanded.210 } }
			# Isolated Vally (mountain)
			12 = { planet_event = { id = colonyexpanded.211 } }
		}
	}
}

# Curious Wildlife
planet_event = {
	id = colonyexpanded.201
	title = "colonyexpanded.201.name"
	desc = "colonyexpanded.201.desc"
	show_sound = event_alien_nature
	picture = GFX_evt_animal_wildlife
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = wildlife_damages }
		OR = {
			has_deposit = d_dangerous_wildlife_blocker
			has_modifier = dangerous_wildlife
		}
	}
	
	immediate = {
		set_planet_flag = wildlife_damages
	}
	
	option = {
		name = UNFORTUNATE
		owner = {
			 add_resource = { energy = -250 minerals = -250 }
		}
	}
}

# volcanic earthquake reveals minerals
planet_event = {
	id = colonyexpanded.202
	title = "colonyexpanded.202.name"
	desc = "colonyexpanded.202.desc"
	show_sound = event_structural_collapse
	picture = {
		trigger = { 
			NOT = { has_global_flag = "has_new_frontiers_mod" }
		}
		picture = GFX_evt_warm_barren
	}
	picture = {
		trigger = { 
			has_global_flag = "has_new_frontiers_mod"
		}
		picture = GFX_evt_volcano
	}
	location = ROOT
	
	is_triggered_only = yes

	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = volcanic_earthquake }
		has_deposit = d_active_volcano
	}
	
	immediate = {
		set_planet_flag = volcanic_earthquake
	}
	
	option = {
		name = OK
		owner = {
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		add_planet_devastation = 20
	}
}

# Volcanic Eruption
planet_event = {
	id = colonyexpanded.203
	title = "colonyexpanded.203.name"
	desc = "colonyexpanded.203.desc"
	show_sound = event_air_raid_siren
	picture = {
		trigger = { 
			NOT = { has_global_flag = "has_new_frontiers_mod" }
		}
		picture = GFX_evt_warm_barren
	}
	picture = {
		trigger = { 
			has_global_flag = "has_new_frontiers_mod"
		}
		picture = GFX_evt_volcano
	}
	location = ROOT
	
	is_triggered_only = yes
		
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = volcanic_eruption }
		has_deposit = d_active_volcano
	}
	
	immediate = {
		set_planet_flag = volcanic_eruption
	}
	
	option = {
		name = TERRIBLE
		add_modifier = {
			modifier = "recent_eruption"
			days = 3600
		}
		add_planet_devastation = 50
		if = {
			limit = { free_district_slots > 0 }
			add_deposit = d_city_ruins
		}
		random_pop = {
			limit = {
				OR = {
					is_pop_category = worker
					is_pop_category = simple_drone
					is_enslaved = yes
				}
			}
			kill_pop = yes
		}
		random_pop = {
			limit = {
				OR = {
					is_pop_category = worker
					is_pop_category = simple_drone
					is_enslaved = yes
				}
			}
			kill_pop = yes
		}
	}
}

# Hungry Wildlife
planet_event = {
	id = colonyexpanded.204
	title = "colonyexpanded.204.name"
	desc = "colonyexpanded.204.desc"
	show_sound = event_alien_nature
	picture = GFX_evt_animal_wildlife
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = wildlife_hungry }
		OR = {
			has_deposit = d_dangerous_wildlife_blocker
			has_modifier = dangerous_wildlife
		}
		free_district_slots > 0
	}
	
	immediate = {
		set_planet_flag = wildlife_hungry
	}
	
	option = {
		name = UNFORTUNATE
		add_deposit = d_dangerous_wildlife_blocker
		random_pop = {
			limit = {
				OR = {
					is_pop_category = worker
					is_pop_category = simple_drone
					is_enslaved = yes
				}
			}
			kill_pop = yes
		}
	}
}

# Sinkhole Deposit
planet_event = {
	id = colonyexpanded.205
	title = "colonyexpanded.205.name"
	desc = "colonyexpanded.205.desc"
	show_sound = event_structural_collapse
	picture = GFX_evt_arid
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = sinkhole_minerals }
		free_district_slots > 0
		has_deposit = d_deep_sinkhole
	}

	immediate = {
		set_planet_flag = sinkhole_minerals
	}
	
	option = {
		name = FASCINATING
		add_deposit = d_deep_sinkhole
		add_deposit = d_ore_rich_caverns
	}
}

# Sinkhole Collapses 
planet_event = {
	id = colonyexpanded.206
	title = "colonyexpanded.206.name"
	desc = "colonyexpanded.206.desc"
	show_sound = event_structural_collapse
	picture = GFX_evt_arid
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = sinkhole_collapse }
		has_deposit = d_deep_sinkhole
	}
	
	immediate = {
		set_planet_flag = sinkhole_collapse
	}
	
	option = {
		name = OK
		remove_deposit = d_deep_sinkhole
		add_deposit = d_collapsed_sinkhole
	}
}

# Biological Research
planet_event = {
	id = colonyexpanded.207
	title = "colonyexpanded.207.name"
	desc = "colonyexpanded.207.desc"
	show_sound = event_alien_nature
	picture = GFX_evt_alien_nature
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = biological_studies_tileblocker }
		OR = {
			AND = {
				has_deposit = d_dangerous_wildlife_blocker
				owner = { NOT = { has_technology = tech_dangerous_wildlife } }
			}
			AND = {
				has_deposit = d_dense_jungle
				owner = { NOT = { has_technology = tech_dense_jungle } }
			}
			AND = {
				has_deposit = d_noxious_swamp
				owner = { NOT = { has_technology = tech_noxious_swamp } }
			}
			AND = {
				has_deposit = d_toxic_kelp
				owner = { NOT = { has_technology = tech_toxic_kelp } }
			}
		}
	}
	
	immediate = {
		set_planet_flag = biological_studies_tileblocker
	}
	
	option = {
		name = FASCINATING
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier1researchreward
				min = @tier1researchmin
				max = @tier1researchmax
			}
		}
		random_list = {
			25 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_deposit = d_dangerous_wildlife_blocker }
						owner = { has_technology = tech_dangerous_wildlife }
					}
				}
				owner = {
					add_research_option = tech_dangerous_wildlife
					add_tech_progress = {
						tech = tech_dangerous_wildlife
						progress = 0.20
					}
				}
			}
			25 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_deposit = d_dense_jungle }
						owner = { has_technology = tech_dense_jungle }
					}
				}
				owner = {
					add_research_option = tech_dense_jungle
					add_tech_progress = {
						tech = tech_dense_jungle
						progress = 0.20
					}
				}
			}
			25 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_deposit = d_noxious_swamp }
						owner = { has_technology = tech_noxious_swamp }
					}
				}
				owner = {
					add_research_option = tech_noxious_swamp
					add_tech_progress = {
						tech = tech_noxious_swamp
						progress = 0.20
					}
				}
			}
			25 = {
				modifier = {
					factor = 0
					OR = {
						NOT = { has_deposit = d_toxic_kelp }
						owner = { has_technology = tech_toxic_kelp }
					}
				}
				owner = {
					add_research_option = tech_toxic_kelp
					add_tech_progress = {
						tech = tech_toxic_kelp
						progress = 0.20
					}
				}
			}
		}
	}
}

# Fertile Volcanic Lands
planet_event = {
	id = colonyexpanded.208
	title = "colonyexpanded.208.name"
	desc = "colonyexpanded.208.desc"
	show_sound = event_alien_nature
	picture = {
		trigger = { 
			NOT = { has_global_flag = "has_new_frontiers_mod" }
		}
		picture = GFX_evt_warm_barren
	}
	picture = {
		trigger = { 
			has_global_flag = "has_new_frontiers_mod"
		}
		picture = GFX_evt_volcano
	}
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = volcanic_fertile }
		has_deposit = d_active_volcano
	}
	
	immediate = {
		set_planet_flag = volcanic_fertile
	}
	
	option = {
		name = FASCINATING
		add_deposit = d_black_soil
	}
}

# Mineral Rich Mountain
planet_event = {
	id = colonyexpanded.209
	title = "colonyexpanded.209.name"
	desc = "colonyexpanded.209.desc"
	show_sound = event_default
	picture = {
		trigger = {
			OR = {
				is_wet =  yes
				is_planet_class = pc_gaia
				is_planet_class = pc_hive
			}
		}
		picture = GFX_evt_continental
	}
	picture = {
		trigger = { 
			is_dry = yes
		}
		picture = GFX_evt_arid
	}
	picture = {
		trigger = { 
			is_cold = yes
		}
		picture = GFX_evt_arctic
	}
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		NOT = { has_planet_flag = mineral_mountains }
		has_deposit = d_mountain_range
		NOT = { has_modifier = mineral_poor }
		OR = {
			is_wet = yes
			is_dry = yes
			is_cold = yes
			is_planet_class = pc_gaia
			is_planet_class = pc_hive
		}
	}
	
	immediate = {
		set_planet_flag = mineral_mountains
	}
	
	option = {
		name = EXCELLENT
		add_deposit = d_rich_mountain
	}
}

# Exotic Gas Swamp 
planet_event = {
	id = colonyexpanded.210
	title = "colonyexpanded.210.name"
	desc = "colonyexpanded.210.desc"
	show_sound = event_alien_nature
	picture = GFX_evt_tundra
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		has_deposit = d_noxious_swamp
		free_district_slots > 0
		exists = owner
		owner = {
			NOT = { has_country_flag = exotic_gas_swamp }
		}
	}
	
	immediate = {
		owner = {
			set_country_flag = exotic_gas_swamp
		}
	}
	
	option = {
		name = EXCELLENT
		add_deposit = d_noxious_swamp
		add_deposit = d_bubbling_swamp
	}
}

# Isolated Vally
planet_event = {
	id = colonyexpanded.211
	title = "colonyexpanded.211.name"
	desc = "colonyexpanded.211.desc"
	show_sound = event_alien_nature
	picture = GFX_evt_continental
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		num_pops > 3
		has_deposit = d_mountain_range
		NOT = { add_deposit = d_alien_pets_deposit }
		exists = owner
		owner = {
			NOT = { has_country_flag = mountain_pets }
		}
	}
	
	immediate = {
		owner = {
			set_country_flag = mountain_pets
		}
	}
	
	option = {
		name = FASCINATING
		add_deposit = d_alien_pets_deposit
	}
}

##################################
# Various Colony Events
# Reserved 299 - 399
##################################

### Randomly spawn planet modifier events ###
event = {
	id = colonyexpanded.299
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			random_list = {
				5 = {
					random_owned_planet = {
						limit = {
							OR = {
								AND = {
									has_modifier = "strong_magnetic_field"
									NOT = { has_modifier = "magnetic_research_boost" }
									NOT = { has_modifier = "magnetic_disruption" }
								}
								AND = {	
									has_modifier = asteroid_impacts
									NOT = { has_planet_flag = asteroid_defences_colony_flag }
								}
								AND = {
									has_modifier = unstable_tectonics
									NOT = { has_modifier = recent_quake }
								}
								AND = {
									has_modifier = "asteroid_belt"
									NOR = { 
										has_modifier = "recent_comet" 
										owner = { has_ethic = ethic_gestalt_consciousness }
									}
								}
							}
							is_under_colonization = no
							colony_age > 10
						}
						planet_event = { id = colony_mod.161 days = 180 random = 720 }
					}
				}
				95 = {
					# nothing happens
				}
			}
		}
	}
}

### Find fossilized titanic life ###
planet_event = {
	id = colonyexpanded.300
	title = "colonyexpanded.300.name"
	desc = "colonyexpanded.300.desc"
	show_sound = event_alien_nature
	picture = GFX_evt_alien_nature
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_modifier = titanic_life }
		NOT = { is_planet_class = pc_nuked }
		habitable_structure = no
	}
	
	option = {
		name = FASCINATING
		add_deposit = d_titanic_fossils
	}
}

### Terraforming Candidate ###
ship_event = {
	id = colonyexpanded.310
	title = "anomaly.2575.name"
	desc = {
		text = anomaly.2575.desc.1
		trigger = { 
			NOT = { 
				owner = { has_technology = "tech_climate_restoration" } 
			}
		}
	}
	desc = {
		text = anomaly.2575.desc.2
		trigger = { 
			owner = { has_technology = "tech_climate_restoration" }
		}
	}
	picture = GFX_evt_drilling_for_gas
	location = FROM
	
	is_triggered_only = yes
	
	trigger = { FROM = { has_modifier = "terraforming_candidate" } }
	
	option = {
		name = FASCINATING
		custom_tooltip = TERRAFORMING_CANDIDATE_EFFECT
	}
}

### colony discovered to have presapients ###
planet_event = {
	id = colonyexpanded.311
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		years_passed > 30
		owner = {
			NOR = {
				has_country_flag = found_presapients
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		habitable_planet = yes
		NOT = { is_planet_class = pc_gaia }
	}
	
	immediate = {
		random_list = {
			1 = {
				owner = {
					set_country_flag = found_presapients
				}
				random_list = {
					15 = {
						create_species = {
							name = random
							class = "PRE_MAM"
							portrait = random
							traits = {
								trait = random_presapient_trait
							}
							homeworld = FROM
							sapient = no
						}
					}
					15 = {
						create_species = {
							name = random
							class = "PRE_REP"
							portrait = random
							traits = {
								trait = random_presapient_trait
							}
							homeworld = FROM
							sapient = no
						}
					}
					15 = {
						create_species = {
							name = random
							class = "PRE_AVI"
							portrait = random
							traits = {
								trait = random_presapient_trait
							}
							homeworld = FROM
							sapient = no
						}
					}
					15 = {
						create_species = {
							name = random
							class = "PRE_ART"
							portrait = random
							traits = {
								trait = random_presapient_trait
							}
							homeworld = FROM
							sapient = no
						}
					}
					15 = {
						create_species = {
							name = random
							class = "PRE_MOL"
							portrait = random
							traits = {
								trait = random_presapient_trait
							}
							homeworld = FROM
							sapient = no
						}
					}
					15 = {
						create_species = {
							name = random
							class = "PRE_FUN"
							portrait = random
							traits = {
								trait = random_presapient_trait
							}
							homeworld = FROM
							sapient = no
						}
					}
				}
				while = {
					limit = {
						count_pops = {
							limit = { is_sapient = no }
							count < 3
						}
					}
					create_pop = { species = last_created }
				}
				planet_event = { id = colonyexpanded.312 }
			}
			99 = {
				# nothing happens
			}
		}
	}
}

planet_event = {
	id = colonyexpanded.312
	title = "uplift.6080.name"
	desc = "colonyexpanded.312.desc"
	picture = GFX_evt_microscopic_life
	location = ROOT
	show_sound = event_default
	
	is_triggered_only = yes
	
	option = {
		name = uplift.6000.a
		trigger = {
			owner = { has_technology = "tech_epigenetic_triggers" }
		}
	}

	option = {
		name = uplift.6000.b
		trigger = {
			owner = { NOT = { has_technology = "tech_epigenetic_triggers" } }
		}
	}
}

##################################
# Crime Colony Events
# Reserved 400 - 499
##################################

# Criminal Underworld Appears (Low Stability)
planet_event = {
	id = colonyexpanded.400
	title = crime.40.name
	desc = colonyexpanded.400.desc
	picture = GFX_evt_dark_alley
	show_sound = event_criminal_activity
	location = root

	trigger = {
		has_owner = yes
		owner = {
			is_country_type = default
			is_gestalt = no
		}
		NOR = {
			has_planet_flag = criminal_underworld_event_up
			has_modifier = unemployment_benefits
			has_modifier = activity_program
			has_modifier = standby_mode
			has_modifier = criminal_underworld
			has_modifier = drone_deviancy
			has_modifier = drone_corruption
			has_modifier = gang_wars
			has_modifier = center_of_drug_trade
			has_modifier = mob_rule
		}
		NOT = { has_planet_flag = criminal_underworld_disappeared } # Cooldown
		num_pops > 0
		planet_crime >= 10
		planet_stability < 35
	}

	mean_time_to_happen = {
		months = 180

		modifier = {
			factor = 0.5
			planet_stability < 25
		}
		modifier = {
			factor = 0.5
			planet_stability < 15
		}
		modifier = {
			factor = 0.5
			planet_stability < 5
		}	
	}

	immediate = {
		set_planet_flag = criminal_underworld_event_up
		set_timed_planet_flag = { flag = criminal_underworld_appeared days = 3600 }
		add_modifier = { modifier = "criminal_underworld" days = -1 }
	}

	after = {
		hidden_effect = {
			remove_planet_flag = criminal_underworld_event_up
		}
	}
	
	option = {
		name = crime.40.a
		tooltip = {
			add_modifier = { modifier = "criminal_underworld" days = -1 }
		}
	}
}

##################################
# Portal Events
# Reserved 500 - 599
##################################

# Portal Refugees
planet_event = {
	id = colonyexpanded.500
	title = colonyexpanded.500.name
	desc = colonyexpanded.500.desc
	picture = GFX_evt_burning_settlement
	show_sound = event_air_raid_siren
	location = root
	
	is_triggered_only = yes
	
	trigger = {
		has_modifier = dportal_trade_crisis
	}
	
	option = {
		name = OK
		create_pop = { 
			species = owner_main_species
		}
		last_created_pop = {
			hidden_effect = {
				add_modifier = { modifier = recent_refugee days = 3600 }
			}
		}
	}
}

# Warp Beast Truce
planet_event = {
	id = colonyexpanded.501
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.501.desc
		trigger = {
			 owner = { is_machine_empire = no }
		}
	}
	desc = {
		text = colonyexpanded.501.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	immediate = {
		planet_event = { id = colonyexpanded.502 days = 1800 random = 1800 }
		owner = {
			set_country_flag = dportal_empire_truce_flag
			hidden_effect = {
				change_variable = {
					which = dportal_empire_final_victory
					value = 1
				}
			}
		}
	}
	
	option = {
		name = colonyexpanded.501.a
		trigger = { owner = { is_machine_empire = no } }
		if = {
			limit = { has_global_flag = expanded_pops_active }
			custom_tooltip = portal_rare_tooltip
			hidden_effect = { set_planet_flag = dportal_trade_truce }
		}
	}
	option = {
		name = colonyexpanded.501.a.robot
		trigger = { owner = { is_machine_empire = yes } }
		if = {
			limit = { has_global_flag = expanded_pops_active }
			custom_tooltip = portal_rare_tooltip
			hidden_effect = { set_planet_flag = dportal_trade_truce }
		}
	}
}

# Warp Beast Truce Ends
planet_event = {
	id = colonyexpanded.502
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.502.desc
		trigger = {
			 owner = { is_machine_empire = no }
		}
	}
	desc = {
		text = colonyexpanded.502.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	option = {
		name = colonyexpanded.502.a
		trigger = { owner = { is_machine_empire = no } }
		if = {
			limit = { has_global_flag = expanded_pops_active }
			custom_tooltip = portal_no_rare_tooltip
			hidden_effect = { remove_planet_flag = dportal_trade_truce }
		}
		hidden_effect = {
			owner = {
				remove_country_flag = dportal_empire_truce_flag
				set_variable = { which = dportal_empire_victory value = 0 }
			}
		}
	}
	option = {
		name = colonyexpanded.501.a.robot
		trigger = { owner = { is_machine_empire = yes } }
		if = {
			limit = { has_global_flag = expanded_pops_active }
			custom_tooltip = portal_no_rare_tooltip
			hidden_effect = { remove_planet_flag = dportal_trade_truce }
		}
		hidden_effect = {
			owner = {
				remove_country_flag = dportal_empire_truce_flag
				set_variable = { which = dportal_empire_victory value = 0 }
			}
		}
	}
}

# unemployed volunteers
planet_event = {
	id = colonyexpanded.503
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.503.desc
		trigger = {
			 owner = { is_machine_empire = no }
		}
	}
	desc = {
		text = colonyexpanded.503.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	trigger = {
		exists = owner
		owner = {
			is_at_war = no
			any_owned_pop = { is_unemployed = yes }
		}
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	option = {
		name = colonyexpanded.503.a
		trigger = { owner = { is_machine_empire = no } }
		response_text = colonyexpanded.503.a.response
		dportal_empire_victory_increase = yes
		custom_tooltip = colonyexpanded.503.a.tooltip
		hidden_effect = {
			owner = {
				while = {
					count = 5
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
				}
			}
		}
	}
	option = {
		name = colonyexpanded.503.b
		trigger = { owner = { is_machine_empire = no } }
		response_text = colonyexpanded.503.b.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				3 = { }
			}
		}
	}
	option = {
		name = colonyexpanded.503.a.robot
		trigger = { owner = { is_machine_empire = yes } }
		response_text = colonyexpanded.503.a.robot.response
		dportal_empire_victory_increase = yes
		custom_tooltip = colonyexpanded.503.a.tooltip
		hidden_effect = {
			owner = {
				while = {
					count = 5
					random_owned_pop = {
						limit = { is_unemployed = yes }
						kill_pop = yes
					}
				}
			}
		}
	}
	option = {
		name = colonyexpanded.503.b.robot
		trigger = { owner = { is_machine_empire = yes } }
		response_text = colonyexpanded.503.b.robot.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				3 = { }
			}
		}
	}
}

# Asks for alloys
planet_event = {
	id = colonyexpanded.504
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.504.desc
		trigger = {
			 owner = { is_machine_empire = no }
		}
	}
	desc = {
		text = colonyexpanded.504.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	trigger = {
		exists = owner
		owner = {
			is_at_war = no
		}
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	option = {
		name = colonyexpanded.504.a
		trigger = { owner = { is_machine_empire = no } }
		allow = {
			resource_stockpile_compare = { resource = alloys value >= 500 }
		}
		response_text = colonyexpanded.504.a.response
		dportal_empire_victory_increase = yes
		owner = {
			add_resource = {
				alloys = -500
				energy = 500
			}
		}
	}
	option = {
		name = colonyexpanded.504.b
		trigger = { owner = { is_machine_empire = no } }
		response_text = colonyexpanded.504.b.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				2 = { }
			}
		}
	}
	option = {
		name = colonyexpanded.503.a.robot
		trigger = { owner = { is_machine_empire = yes } }
		allow = {
			resource_stockpile_compare = { resource = alloys value >= 500 }
		}
		response_text = colonyexpanded.504.a.robot.response
		dportal_empire_victory_increase = yes
		owner = {
			add_resource = {
				alloys = -500
				energy = 500
			}
		}
	}
	option = {
		name = colonyexpanded.503.b.robot
		trigger = { owner = { is_machine_empire = yes } }
		response_text = colonyexpanded.503.b.robot.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				2 = { }
			}
		}
	}
}

# Asks for food
planet_event = {
	id = colonyexpanded.505
	title = "colonyexpanded.501.name"
	desc = colonyexpanded.505.desc

	is_triggered_only = yes
	
	trigger = {
		exists = owner
		owner = {
			is_at_war = no
			is_synthetic_empire = no
		}
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	option = {
		name = colonyexpanded.504.a
		allow = {
			resource_stockpile_compare = { resource = food value >= 1000 }
		}
		response_text = colonyexpanded.505.a.response
		owner = {
			add_resource = {
				food = -1000
				energy = 500
			}
		}
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_victory_increase = yes }
				3 = { }
			}
		}
		
	}
	option = {
		name = colonyexpanded.504.b
		response_text = colonyexpanded.505.b.response
		dportal_empire_crisis_increase = yes
	}
}

# Live Warp Beast
planet_event = {
	id = colonyexpanded.506
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.506.desc
		trigger = {
			 owner = { is_machine_empire = no }
		}
	}
	desc = {
		text = colonyexpanded.506.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	trigger = {
		exists = owner
		owner = {
			NOT = { has_country_flag = captured_warp_beasts }
		}
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	option = {
		name = colonyexpanded.506.a
		owner = { set_country_flag = captured_warp_beasts }
		enable_special_project = {
			name = "WARP_BEAST_RESEARCH_PROJECT"
			location = this
			owner = root.owner
		}
	}
}

# Live Warp Beast - Reaserch Complete
planet_event = {
	id = colonyexpanded.507
	title = "colonyexpanded.507.name"
	desc = "colonyexpanded.507.desc"
	picture = GFX_evt_society_research

	is_triggered_only = yes
	
	option = {
		name = "EXCELLENT"
		dportal_empire_victory_increase = yes 
		custom_tooltip = colonyexpanded.507.a.tooltip
		owner = {
			add_monthly_resource_mult = {
				resource = physics_research
				value = 50
				min = @tier5researchmin
			}
			set_country_flag = dportal_empire_weapon_1
			hidden_effect = {
				change_variable = {
					which = dportal_empire_final_victory
					value = 1
				}
			}
		}
	}
}

# Gas for Plasma
planet_event = {
	id = colonyexpanded.508
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.508.desc
		trigger = {
			 owner = { is_machine_empire = no }
		}
	}
	desc = {
		text = colonyexpanded.508.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	trigger = {
		exists = owner
		owner = {
			NOT = { has_country_flag = dportal_empire_plasma_gases }
			NOT = { has_technology = tech_plasma_3 }
			is_at_war = no
		}
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	option = {
		name = colonyexpanded.504.a
		trigger = { owner = { is_machine_empire = no } }
		allow = {
			resource_stockpile_compare = { resource = exotic_gases value >= 1000 }
		}
		response_text = colonyexpanded.504.a.response
		dportal_empire_victory_increase = yes
		owner = {
			add_resource = { exotic_gases = -1000 }
			set_country_flag = dportal_empire_plasma_gases
			if = {
				limit = {
					NOT = { has_technology = tech_plasma_1 }
				}
				give_technology = { tech = tech_plasma_1 }
				add_research_option = tech_plasma_2
			}
			else_if = {
				limit = {
					has_technology = tech_plasma_1
					NOT = { has_technology = tech_plasma_2 }
				}
				give_technology = { tech = tech_plasma_2 }
			}
			else_if = {
				limit = {
					has_technology = tech_plasma_2
					NOT = { has_technology = tech_plasma_3 }
				}
				give_technology = { tech = tech_plasma_3 }
			}
		}
	}
	option = {
		name = colonyexpanded.504.b
		trigger = { owner = { is_machine_empire = no } }
		response_text = colonyexpanded.508.b.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				3 = { }
			}
		}
	}
	option = {
		name = colonyexpanded.503.a.robot
		trigger = { owner = { is_machine_empire = yes } }
		allow = {
			resource_stockpile_compare = { resource = exotic_gases value >= 1000 }
		}
		response_text = colonyexpanded.504.a.robot.response
		dportal_empire_victory_increase = yes
		owner = {
			add_resource = { exotic_gases = -1000 }
			set_country_flag = dportal_empire_plasma_gases
			if = {
				limit = {
					NOT = { has_technology = tech_plasma_1 }
				}
				give_technology = { tech = tech_plasma_1 }
				add_research_option = tech_plasma_2
			}
			else_if = {
				limit = {
					has_technology = tech_plasma_1
					NOT = { has_technology = tech_plasma_2 }
				}
				give_technology = { tech = tech_plasma_2 }
			}
			else_if = {
				limit = {
					has_technology = tech_plasma_2
					NOT = { has_technology = tech_plasma_3 }
				}
				give_technology = { tech = tech_plasma_3 }
			}
		}
	}
	option = {
		name = colonyexpanded.503.b.robot
		trigger = { owner = { is_machine_empire = yes } }
		response_text = colonyexpanded.503.b.robot.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				3 = { }
			}
		}
	}
}

# Asks for consumer goods / minerals
planet_event = {
	id = colonyexpanded.509
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.509.desc
		trigger = {
			 owner = { is_gestalt = no }
		}
	}
	desc = {
		text = colonyexpanded.509.desc.hive
		trigger = {
			 owner = { is_hive_empire = yes }
		}
	}
	desc = {
		text = colonyexpanded.509.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	trigger = {
		exists = owner
		owner = {
			is_at_war = no
		}
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	option = {
		name = colonyexpanded.504.a
		trigger = { owner = { is_gestalt = no } }
		allow = {
			resource_stockpile_compare = { resource = consumer_goods value >= 500 }
		}
		response_text = colonyexpanded.504.a.response
		dportal_empire_victory_increase = yes
		owner = {
			add_resource = {
				consumer_goods = -500
				energy = 500
			}
		}
	}
	option = {
		name = colonyexpanded.504.b
		trigger = { owner = { is_machine_empire = no } }
		response_text = colonyexpanded.508.b.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				4 = { }
			}
		}
	}
	option = {
		name = colonyexpanded.504.a
		trigger = { owner = { is_hive_empire = yes } }
		allow = {
			resource_stockpile_compare = { resource = minerals value >= 1000 }
		}
		response_text = colonyexpanded.504.a.response
		dportal_empire_victory_increase = yes
		owner = {
			add_resource = {
				minerals = -1000
				energy = 500
			}
		}
	}
	option = {
		name = colonyexpanded.503.a.robot
		trigger = { owner = { is_machine_empire = yes } }
		allow = {
			resource_stockpile_compare = { resource = minerals value >= 1000 }
		}
		response_text = colonyexpanded.504.a.robot.response
		dportal_empire_victory_increase = yes
		owner = {
			add_resource = {
				minerals = -1000
				energy = 500
			}
		}
	}
	option = {
		name = colonyexpanded.503.b.robot
		trigger = { owner = { is_machine_empire = yes } }
		response_text = colonyexpanded.503.b.robot.response
		hidden_effect = {
			random_list = {
				1 = { dportal_empire_crisis_increase = yes }
				4 = { }
			}
		}
	}
}

# Weapons Research
planet_event = {
	id = colonyexpanded.510
	title = "colonyexpanded.501.name"
	desc = {
		text = colonyexpanded.510.desc
		trigger = {
			 owner = { is_machine_empire = no }
		}
	}
	desc = {
		text = colonyexpanded.510.desc.robot
		trigger = {
			 owner = { is_machine_empire = yes }
		}
	}

	is_triggered_only = yes
	
	trigger = {
		exists = owner
		owner = {
			NOT = { has_country_flag = dportal_lasers_research }
			OR = {
				has_technology = tech_plasma_2
				has_technology = tech_lasers_4
				research_leader = {
					area = physics
					has_trait = "leader_trait_maniacal"
				}
				research_leader = {
					area = physics
					has_trait = "leader_trait_curator"
				}
			}
		}
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = root.owner.leader
		planet_background = root.owner
		graphical_culture = root.owner
		city_level = root.owner
		room = root.owner
	}
	
	immediate = {
		random_owned_leader = {
			limit = {
				leader_class = scientist
				is_researching_area = physics
			}
		}
		save_event_target_as = dead_portal_leader
	}
	
	option = {
		name = colonyexpanded.506.a
		owner = { set_country_flag = dportal_lasers_research }
		enable_special_project = {
			name = "WARP_BEAST_LASER_PROJECT"
			location = this
			owner = root.owner
		}
	}
}

# Weapons Research - Reaserch Complete
planet_event = {
	id = colonyexpanded.511
	title = "colonyexpanded.511.name"
	desc = "colonyexpanded.511.desc"
	picture = GFX_evt_physics_research

	is_triggered_only = yes
	
	option = {
		name = "EXCELLENT"
		dportal_empire_victory_increase = yes 
		custom_tooltip = colonyexpanded.507.a.tooltip
		owner = {
			if = {
				limit = { has_tech_option = tech_lasers_5 }
				add_research_option = tech_lasers_5
				add_tech_progress = {
					tech = tech_lasers_5
					progress = 0.25
				}
			}
			else_if = {
				limit = {
					has_technology = tech_lasers_4
					NOT = { has_technology = tech_lasers_5 }
				}
				add_research_option = tech_lasers_5
				add_tech_progress = {
					tech = tech_lasers_5
					progress = 0.10
				}
			}
			else_if = {
				limit = {
					has_technology = tech_lasers_3
					NOT = { has_technology = tech_lasers_4 }
				}
				add_research_option = tech_lasers_4
				add_tech_progress = {
					tech = tech_lasers_4
					progress = 0.25
				}
			}
			else_if = {
				limit = {
					has_technology = tech_lasers_2
					NOT = { has_technology = tech_lasers_3 }
				}
				add_research_option = tech_lasers_3
				add_tech_progress = {
					tech = tech_lasers_3
					progress = 0.25
				}
			}
			else_if = {
				limit = {
					NOT = { has_technology = tech_lasers_2 }
				}
				add_research_option = tech_lasers_2
				add_tech_progress = {
					tech = tech_lasers_2
					progress = 0.25
				}
			}
			add_modifier = { modifier = dportal_lasers days = -1 }
			set_country_flag = dportal_empire_weapon_2
			hidden_effect = {
				change_variable = {
					which = dportal_empire_final_victory
					value = 1
				}
			}
		}
	}
}