namespace = gai_build

#AI is bad at building... I hate this game.
event = {
	id = gai_build.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
			every_playable_country = {
				limit = {
					is_ai = yes
					is_country_type = "default"
					is_at_war = no
				}
				set_timed_country_flag = { flag = GAI_Country days = 720 }
				country_event = { id = gai_build.2 }
				IF = {
					limit = {
						owner = { 
							has_monthly_income = {
								resource = minerals
								value < 0
							}
							has_resource = { type = minerals amount < 1 }
						}
					}
					country_event = { id = gai_build.3 } 
				}
			}
	}
}

country_event = {
	id = gai_build.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		IF = { #Check for upgradeable buildings
			limit = {
				has_resource = { type = minerals amount > 800 }
			}
			random_owned_planet = {
				LIMIT = {
					has_upgraded_capital = yes
					free_jobs < 2
					is_occupied_flag = no
					has_orbital_bombardment = no
					is_colony = yes
					solar_system = {
						is_within_borders_of = root
					}
					has_building_construction = no
					OR = {
						AND = {
							owner = { has_technology = tech_food_processing_1 }
							has_building = building_hydroponics_farm
						}
						free_housing > 10
						AND = {
							free_housing < -5
							free_district_slots = 0
							OR = {
								has_district = district_mining
								has_district = district_generator
								has_district = district_farming
							}
						}
						AND = {
							owner = { has_technology = tech_heritage_site }
							OR = {
								has_building = building_autochthon_monument
								has_building = building_uplink_node
							}
						}
						AND = {
							owner = { has_technology = tech_frontier_hospital }
							has_building = building_clinic
						}
						AND = {
							owner = { has_technology = tech_hyper_entertainment_forum }
							has_building = building_holo_theatres
						}
						AND = {
							owner = { has_technology = tech_holographic_rituals }
							has_building = building_temple
						}
						AND = {
							owner = { has_technology = tech_hive_cluster }
							has_building = building_hive_node
						}
						AND = {
							owner = { has_technology = tech_global_defense_grid }
							has_building = building_stronghold
						}
						AND = {
							OWNER = {
								OR = {
									has_monthly_income = { resource = rare_crystals  value > 0 }
									has_monthly_income = { resource = volatile_motes  value > 0 }
									has_monthly_income = { resource = exotic_gases  value > 0 }
								}
							}
							OR = {
								AND = {
									OWNER = { has_resource = { type = rare_crystals amount > 100 } }
									OR = {
										AND = {
											owner = {
												has_technology = tech_luxuries_2
											}
											has_building = building_factory_2
										}
										AND = {
											owner = {
												has_technology = tech_housing_2
											}
											has_building = building_hive_warren
										}
										AND = {
											owner = {
												has_technology = tech_micro_replicators
											}
											has_building = building_drone_storage
										}
										AND = {
											owner = {
												has_technology = tech_paradise_dome
											}
											OR = { 
												has_building = building_communal_housing
												has_building = building_luxury_residence
											}
												
										}
										AND = {
											owner = { has_technology = tech_luxuries_1 }
											has_building = building_factory_1
										}
										AND = {
											owner = { has_technology = tech_paradise_dome }
											has_building = building_luxury_residence
										}
										AND = {
											owner = { has_technology = tech_paradise_dome }
											has_building = building_communal_housing
										}
										AND = {
											owner = { has_technology = tech_hypercomms_forum }
											has_major_upgraded_capital = yes
											OR = {
												has_building = building_network_junction
												has_building = building_heritage_site
											}
										}
										AND = {
											owner = { has_technology = tech_autocurating_vault }
											has_fully_upgraded_capital = yes
											OR = {
												has_building = building_system_conflux
												has_building = building_hypercomms_forum
											}
										}
										AND = {
											owner = { has_technology = tech_hive_confluence }
											has_major_upgraded_capital = yes
											has_building = building_hive_cluster
										}
										AND = {
											owner = { has_technology = tech_consecration_fields }
											has_major_upgraded_capital = yes
											has_building = building_holotemple
										}
										AND = {
											owner = { has_technology = tech_transcendent_faith }
											has_fully_upgraded_capital = yes
											has_building = building_sacred_nexus
										}
									}
								}
								AND = {
									OWNER = { has_resource = { type = volatile_motes amount > 100 } }
									OR = {
										AND = {
											owner = { 
												has_technology = tech_alloys_2 
											}
											has_building = building_foundry_2
										}
										AND = {
											owner = {
												has_technology = tech_food_processing_2 
											}
											has_building = building_food_processing_facility
										}
										AND = {
											owner = { has_technology = tech_alloys_1 }
											has_building = building_foundry_1
										}
										AND = {
											owner = { has_technology = tech_mineral_purification_2 }
											has_building = building_mineral_purification_plant
										}
										AND = {
											owner = { has_technology = tech_global_defense_grid }
											has_building = building_stronghold
										}
									}
								}
								AND = {
									OWNER = { has_resource = { type = exotic_gases amount > 100 } }
									OR = {
										AND = {
											owner = { has_technology = tech_power_hub_2 }
											has_building = building_energy_grid
										}
										AND = {
											owner = { has_technology = tech_basic_science_lab_2 }
											has_building = building_research_lab_1
										}
										AND = {
											owner = { has_technology = tech_basic_science_lab_3 }
											has_building = building_research_lab_2
										}
										AND = {
											owner = { has_technology = tech_colonial_centralization }
											has_building = building_precinct_house
										}
									}
								}
							}
						}
					}
				}#End Limit
				IF = {
					limit = {
						owner = { has_technology = tech_food_processing_1 }
						has_building = building_hydroponics_farm
					}
					remove_building = building_hydroponics_farm
					add_building = building_food_processing_facility
					OWNER = {
						add_resource = {
							minerals = -400
						}
					}
				}
				IF = {
					limit = {
						free_housing > 10
						free_district_slots = 0
						OR = {
							has_district = district_city
							has_district = district_hive
							has_district = district_nexus
						}
					}
					IF = {
						limit = {
							owner = { is_regular_empire = yes }
						}
						remove_district = district_city
					}
					ELSE_IF = {
						limit = {
							owner = { is_hive_empire = yes }
						}
						remove_district = district_hive
					}
					ELSE = {
						remove_district = district_nexus
					}
				}
				IF = {
					limit = {
						free_housing < -5
						free_district_slots = 0
						OWNER = {
							has_resource = { type = minerals amount > 500 }
						}
						OR = {
							has_district = district_mining
							has_district = district_generator
							has_district = district_farming
						}
					}
					IF = {
						limit = {
							has_district = district_farming
							owner = { 
								has_monthly_income = {
									resource = food
									value > 10
								}
							}
						}
						OWNER = {
							add_resource = {
								minerals = -500
							}
						}
						remove_district = district_farming
						IF = {
							limit = {
								owner = { is_regular_empire = yes }
							}
							add_district = district_city
						}
						ELSE_IF = {
							limit = {
								owner = { is_hive_empire = yes }
							}
							add_district = district_hive
						}
						ELSE = {
							add_district = district_nexus
						}
					}
					ELSE_IF = {
						limit = {
							has_district = district_mining
							owner = { 
								has_monthly_income = {
									resource = minerals
									value > 10
								}
							}
						}
						OWNER = {
							add_resource = {
								minerals = -500
							}
						}
						remove_district = district_mining
						IF = {
							limit = {
								owner = { is_regular_empire = yes }
							}
							add_district = district_city
						}
						ELSE_IF = {
							limit = {
								owner = { is_hive_empire = yes }
							}
							add_district = district_hive
						}
						ELSE = {
							add_district = district_nexus
						}
					}
					ELSE_IF = {
						limit = {
							has_district = district_generator
							owner = { 
								has_monthly_income = {
									resource = energy
									value > 10
								}
							}
						}
						OWNER = {
							add_resource = {
								minerals = -500
							}
						}
						remove_district = district_generator
						IF = {
							limit = {
								owner = { is_regular_empire = yes }
							}
							add_district = district_city
						}
						ELSE_IF = {
							limit = {
								owner = { is_hive_empire = yes }
							}
							add_district = district_hive
						}
						ELSE = {
							add_district = district_nexus
						}
					}
				}				
				ELSE_IF = {
					limit = {
						owner = { has_technology = tech_heritage_site }
						OR = {
							has_building = building_autochthon_monument
							has_building = building_uplink_node
							has_building = building_corporate_monument
						}
					}
					IF = {
						LIMIT = {
							has_building = building_autochthon_monument
						}
						remove_building = building_autochthon_monument
						add_building = building_heritage_site
						OWNER = {
							add_resource = {
								minerals = -400
							}
						}
					}
					ELSE_IF = {
						LIMIT = {
							has_building = building_corporate_monument
						}
						remove_building = building_corporate_monument
						add_building = building_corporate_site
						OWNER = {
							add_resource = {
								minerals = -400
							}
						}
					}
					ELSE = {
						remove_building = building_uplink_node
						add_building = building_network_junction
						OWNER = {
							add_resource = {
								minerals = -400
							}
						}
					}
				}
				ELSE_IF = {
					limit = {
						owner = { has_technology = tech_holographic_rituals }
						has_building = building_temple
					}
					remove_building = building_temple
					add_building = building_holotemple
					OWNER = {
						add_resource = {
							minerals = -400
						}
					}
				}
				ELSE_IF = {
					limit = {
						owner = { has_technology = tech_hive_cluster }
						has_building = building_hive_node
					}
					remove_building = building_hive_node
					add_building = building_hive_cluster
					OWNER = {
						add_resource = {
							minerals = -400
						}
					}
				}
				ELSE_IF = {
					limit = {
						OR = {
							OWNER = {has_monthly_income = { resource = rare_crystals  value > 2 } }
							OWNER = {has_monthly_income = { resource = volatile_motes  value > 2 } }
							OWNER = {has_monthly_income = { resource = exotic_gases  value > 2 } }
						}
					}
					IF = {
						LIMIT = {
							OWNER = {
								has_resource = { type = volatile_motes amount > 100 } 
								has_monthly_income = { resource = volatile_motes  value > 2 }
							}
						}
						IF = {
							LIMIT = {
								owner = { 
									has_technology = tech_alloys_1 
								}
								has_building = building_foundry_1
							}
							remove_building = building_foundry_1
							add_building = building_foundry_2
							owner = {
								add_resource = {
									minerals = -600
									volatile_motes = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { 
									has_technology = tech_alloys_2 
								}
								has_building = building_foundry_2
							}
							remove_building = building_foundry_2
							add_building = building_foundry_3
							OWNER = {
								add_resource = {
									minerals = -800
									volatile_motes = -100
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_global_defense_grid }
								has_building = building_stronghold
							}
							remove_building = building_stronghold
							add_building = building_fortress
							OWNER = {
								add_resource = {
									minerals = -400
									volatile_motes = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = {
									has_technology = tech_food_processing_2 
								}
								has_building = building_food_processing_facility
							}
							remove_building = building_food_processing_facility
							add_building = building_food_processing_center
							OWNER = {
								add_resource = {
									minerals = -500
									volatile_motes = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_mineral_purification_2 }
								has_building = building_mineral_purification_plant
							}
							remove_building = building_mineral_purification_plant
							owner = {
								add_resource = {
									minerals = -500
									volatile_motes = -50
								}
							}
						}
					}
					IF = {
						limit = {
							OWNER = {
								has_resource = { type = rare_crystals amount > 100 }
								has_monthly_income = { resource = rare_crystals  value > 2 }
							}
						}
						IF = {
							LIMIT = {
								owner = { has_technology = tech_luxuries_2 }
								has_building = building_factory_2
							}
							remove_building = building_factory_2
							add_building = building_factory_3
							OWNER = {
								add_resource = {
									minerals = -800
									rare_crystals = -100
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_housing_2 }
								has_building = building_hive_warren
							}
							remove_building = building_hive_warren
							add_building = building_expanded_warren
							OWNER = {
								add_resource = {
									minerals = -500
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_micro_replicators }
								has_building = building_drone_storage
							}
							remove_building = building_drone_storage
							add_building = building_drone_megastorage
							OWNER = {
								add_resource = {
									minerals = -500
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_paradise_dome }
								has_building = building_luxury_residence
							}
							remove_building = building_luxury_residence
							add_building = building_paradise_dome
							OWNER = {
								add_resource = {
									minerals = -500
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_paradise_dome }
								has_building = building_communal_housing
							}
							remove_building = building_communal_housing
							add_building = building_communal_housing_large
							OWNER = {
								add_resource = {
									minerals = -500
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_luxuries_1 }
								has_building = building_factory_1
							}
							remove_building = building_factory_1
							add_building = building_factory_2
							OWNER = {
								add_resource = {
									minerals = -600
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_paradise_dome }
								has_building = building_communal_housing
							}
							remove_building = building_communal_housing
							add_building = building_communal_housing_large
							OWNER = {
								add_resource = {
									minerals = -500
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							LIMIT = {
								owner = { has_technology = tech_paradise_dome }
								has_building = building_luxury_residence
							}
							remove_building = building_luxury_residence
							add_building = building_paradise_dome
							OWNER = {
								add_resource = {
									minerals = -500
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_hypercomms_forum }
								has_major_upgraded_capital = yes
								OR = {
									has_building = building_network_junction
									has_building = building_heritage_site
									has_building = building_corporate_site
								}
							}
							IF = {
								limit = {
									has_building = building_network_junction
								}
								remove_building = building_network_junction
								add_building = building_system_conflux
								OWNER = {
									add_resource = {
										minerals = -600
										rare_crystals = -50
									}
								}
							}
							ELSE_IF = {
								limit = {
									has_building = building_corporate_site
								}
								remove_building = building_corporate_site
								add_building = building_corporate_forum
								OWNER = {
									add_resource = {
										minerals = -600
										rare_crystals = -50
									}
								}
							}
							ELSE = {
								remove_building = building_heritage_site
								add_building = building_hypercomms_forum
								OWNER = {
									add_resource = {
										minerals = -600
										rare_crystals = -50
									}
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_autocurating_vault }
								has_fully_upgraded_capital = yes
								OR = {
									has_building = building_system_conflux
									has_building = building_hypercomms_forum
									has_building = building_corporate_forum
								}
							}
							IF = {
								limit = {
									has_building = building_system_conflux
								}
								remove_building = building_system_conflux
								add_building = building_alpha_hub
								OWNER = {
									add_resource = {
										minerals = -1000
										rare_crystals = -50
									}
								}
							}
							ELSE_IF = {
								limit = {
									has_building = building_corporate_forum
								}
								remove_building = building_corporate_forum
								add_building = building_corporate_vault
								OWNER = {
									add_resource = {
										minerals = -600
										rare_crystals = -50
									}
								}
							}
							ELSE = {
								remove_building = building_hypercomms_forum
								add_building = building_autocurating_vault
								OWNER = {
									add_resource = {
										minerals = -1000
										rare_crystals = -50
									}
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_hive_confluence }
								has_major_upgraded_capital = yes
								has_building = building_hive_cluster
							}
							remove_building = building_hive_cluster
							add_building = building_hive_confluence
							OWNER = {
								add_resource = {
									minerals = -600
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_consecration_fields }
								has_major_upgraded_capital = yes
								has_building = building_holotemple
							}
							remove_building = building_holotemple
							add_building = building_sacred_nexus
							OWNER = {
								add_resource = {
									minerals = -600
									rare_crystals = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_transcendent_faith }
								has_fully_upgraded_capital = yes
								has_building = building_sacred_nexus
							}
							remove_building = building_sacred_nexus
							add_building = building_citadel_of_faith
							OWNER = {
								add_resource = {
									minerals = -1000
									rare_crystals = -50
								}
							}
						}
					}
					IF = {
						LIMIT = {
							OWNER = {
								has_resource = { type = exotic_gases amount > 100 } 
								has_monthly_income = { resource = exotic_gases  value > 2 }
							}
						}
						IF = {
							limit = {
								owner = { has_technology = tech_power_hub_2 }
								has_building = building_energy_grid
							}
							remove_building = building_energy_grid
							add_building = building_energy_nexus
							owner = {
								add_resource = {
									minerals = -500
									exotic_gases = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_hyper_entertainment_forum }
								has_building = building_holo_theatres
							}
							remove_building = building_holo_theatres
							add_building = building_hyper_entertainment_forum
							owner = {
								add_resource = {
									minerals = -500
									exotic_gases = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_frontier_hospital }
								has_building = building_clinic
							}
							remove_building = building_clinic
							add_building = building_hospital
							owner = {
								add_resource = {
									minerals = -500
									exotic_gases = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_basic_science_lab_2 }
								has_building = building_research_lab_1
							}
							remove_building = building_research_lab_1
							add_building = building_research_lab_2
							owner = {
								add_resource = {
									minerals = -600
									exotic_gases = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_colonial_centralization }
								has_building = building_precinct_house
							}
							remove_building = building_precinct_house
							add_building = building_hall_judgment
							owner = {
								add_resource = {
									minerals = -600
									exotic_gases = -50
								}
							}
						}
						ELSE_IF = {
							limit = {
								owner = { has_technology = tech_basic_science_lab_3 }
								has_building = building_research_lab_2
							}
							remove_building = building_research_lab_2
							add_building = building_research_lab_3
							owner = {
								add_resource = {
									minerals = -800
									exotic_gases = -100
								}
							}
						}
					}
				}
			}#end random owned planet
		}#End if check
	}
}


country_event = {
	id = gai_build.3
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_owned_planet = {
			IF = { 
				limit = { has_building = building_chemical_plant }
				remove_building = building_chemical_plant
			}
			IF = { 
				limit = { has_building = building_crystal_plant }
				remove_building = building_crystal_plant
			}
			IF = { 
				limit = { has_building = building_refinery }
				remove_building = building_refinery
			}
			IF = { 
				limit = { 
					has_district = district_farming
					owner = { has_monthly_income = { resource = food value > 55 } }
				}
				remove_district = district_farming
			}
			IF = { 
				limit = { 
					has_district = district_generator
					owner = { has_monthly_income = { resource = energy value > 55 } }
				}
				remove_district = district_generator
			}
		}
	}
}